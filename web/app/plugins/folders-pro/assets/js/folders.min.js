!function(a){"use strict";"function"==typeof define&&define.amd?define(["jquery"],a):"undefined"!=typeof module&&module.exports?module.exports=a(require("jquery")):a(jQuery)}(function($,b){var c,d,e,f,g,h,i,j,k,l="",m=!1,n=!1,o=0,p=0,q=0,r=!1,s="",t=[],u=wcp_settings.page_url,v=[],w=0,x=0,y="<li class='grid-view' data-id='__folder_id__' id='folder___folder_id__'><div class='folder-item is-folder' data-id='__folder_id__'><a title='__folder_name__' id='folder_view___folder_id__'class='folder-view __append_class__ has-new-folder'data-id='__folder_id__'><span class='folder item-name'><span id='wcp_folder_text___folder_id__'class='folder-title'>__folder_name__</span></span></a></div></li>",z=null,A=null,B=1,C=0,D="",E="",F=0,G=0,H=0,I=0;function J(){ah(),$(".wcp-move-file:not(.ui-draggable)").draggable({revert:"invalid",containment:"document",helper:"clone",cursor:"move",start:function(a,b){$(this).closest("td").addClass("wcp-draggable"),$("body").addClass("no-hover-css")},stop:function(a,b){$(this).closest("td").removeClass("wcp-draggable"),$("body").removeClass("no-hover-css")}}),$(".wcp-move-multiple:not(.ui-draggable)").draggable({revert:"invalid",containment:"document",helper:function(a,b){return($(".selected-items").remove(),(selectedItems=$("#the-list th input:checked").length)>0)?$("<div class='selected-items'><span class='total-post-count'>"+(selectedItems=0==selectedItems||1==selectedItems?"1 Item":selectedItems+" Items")+" Selected</span></div>"):$("<div class='selected-items'><span class='total-post-count'>Select Items to move</span></div>")},start:function(a,b){$("body").addClass("no-hover-css")},cursor:"move",cursorAt:{left:0,top:0},stop:function(a,b){$(".selected-items").remove(),$("body").removeClass("no-hover-css")}}),$("#js-tree-menu .jstree-anchor:not(.ui-droppable)").droppable({accept:".wcp-move-file, .wcp-move-multiple, .attachments-browser li.attachment",hoverClass:"wcp-drop-hover",classes:{"ui-droppable-active":"ui-state-highlight"},drop:function(b,a){folderID=$(this).closest("li.jstree-node").attr("id"),a.draggable.hasClass("wcp-move-multiple")?$(".wp-list-table input:checked").length&&(chkStr="",$(".wp-list-table input:checked").each(function(){chkStr+=$(this).val()+","}),c=L(folderID,"nonce"),$.ajax({url:wcp_settings.ajax_url,data:"post_ids="+chkStr+"&type="+wcp_settings.post_type+"&action=wcp_change_multiple_post_folder&folder_id="+folderID+"&nonce="+c+"&status="+wcp_settings.taxonomy_status+"&taxonomy="+l,method:"post",success:function(a){"1"==(a=$.parseJSON(a)).status?(N(),K()):($(".folder-popup-form").hide(),$(".folder-popup-form").removeClass("disabled"),$("#error-folder-popup-message").html(a.message),$("#error-folder-popup").show())}})):a.draggable.hasClass("wcp-move-file")?(postID=a.draggable[0].attributes["data-id"].nodeValue,c=L(folderID,"nonce"),chkStr=postID+",",$(".wp-list-table input:checked").each(function(){$(this).val()!=postID&&(chkStr+=$(this).val()+",")}),$.ajax({url:wcp_settings.ajax_url,data:"post_ids="+chkStr+"&type="+wcp_settings.post_type+"&action=wcp_change_multiple_post_folder&folder_id="+folderID+"&nonce="+c+"&status="+wcp_settings.taxonomy_status+"&taxonomy="+l,method:"post",success:function(a){"1"==(a=$.parseJSON(a)).status?(N(),K()):($(".folder-popup-form").hide(),$(".folder-popup-form").removeClass("disabled"),$("#error-folder-popup-message").html(a.message),$("#error-folder-popup").show())}})):a.draggable.hasClass("attachment")&&(chkStr=a.draggable[0].attributes["data-id"].nodeValue,c=L(folderID,"nonce"),$(".attachments-browser li.attachment.selected").length>1&&(chkStr="",$(".attachments-browser li.attachment.selected").each(function(){chkStr+=$(this).data("id")+","})),s=chkStr,$.ajax({url:wcp_settings.ajax_url,data:"post_ids="+chkStr+"&type="+wcp_settings.post_type+"&action=wcp_change_multiple_post_folder&folder_id="+folderID+"&nonce="+c+"&status="+wcp_settings.taxonomy_status+"&taxonomy="+l,method:"post",success:function(a){N(),K()}}))}}),$(".un-categorised-items:not(.ui-droppable)").droppable({accept:".wcp-move-file, .wcp-move-multiple, .attachments-browser li.attachment",hoverClass:"wcp-hover-list",classes:{"ui-droppable-active":"ui-state-highlight"},drop:function(b,a){folderID=-1,c=wcp_settings.nonce,a.draggable.hasClass("wcp-move-multiple")?$(".wp-list-table input:checked").length&&(chkStr="",$(".wp-list-table input:checked").each(function(){chkStr+=$(this).val()+","}),ae(chkStr)):a.draggable.hasClass("wcp-move-file")?(chkStr=(postID=a.draggable[0].attributes["data-id"].nodeValue)+",",$(".wp-list-table input:checked").each(function(){postID!=$(this).val()&&(chkStr+=$(this).val()+",")}),ae(chkStr)):a.draggable.hasClass("attachment")&&(chkStr=a.draggable[0].attributes["data-id"].nodeValue,$(".attachments-browser li.attachment.selected").length>1&&(chkStr="",$(".attachments-browser li.attachment.selected").each(function(){chkStr+=$(this).data("id")+","})),s=chkStr,ae(chkStr))}}),$(".attachments-browser li.attachment:not(.ui-draggable)").draggable({revert:"invalid",containment:"document",helper:function(a,b){return $(".selected-items").remove(),selectedItems=0==(selectedItems=$(".attachments-browser li.attachment.selected").length)||1==selectedItems?"1 Item":selectedItems+" Items",$("<div class='selected-items'><span class='total-post-count'>"+selectedItems+" Selected</span></div>")},start:function(a,b){$("body").addClass("no-hover-css")},cursor:"move",cursorAt:{left:0,top:0},stop:function(a,b){$(".selected-items").remove(),$("body").removeClass("no-hover-css")}}),$(".tree-structure .folder-item:not(.ui-droppable)").droppable({accept:".wcp-move-file, .wcp-move-multiple, .attachments-browser li.attachment",hoverClass:"wcp-drop-hover-list",classes:{"ui-droppable-active":"ui-state-highlight"},drop:function(b,a){$("body").removeClass("no-hover-css"),folderID=$(this).data("id"),a.draggable.hasClass("wcp-move-multiple")?(c=L(folderID,"nonce"),$(".wp-list-table input:checked").length&&(chkStr="",$(".wp-list-table input:checked").each(function(){chkStr+=$(this).val()+","}),$.ajax({url:wcp_settings.ajax_url,data:"post_ids="+chkStr+"&type="+wcp_settings.post_type+"&action=wcp_change_multiple_post_folder&folder_id="+folderID+"&nonce="+c+"&status="+wcp_settings.taxonomy_status+"&taxonomy="+l,method:"post",success:function(a){N(),aa(),K()}}))):a.draggable.hasClass("wcp-move-file")?(postID=a.draggable[0].attributes["data-id"].nodeValue,c=L(folderID,"nonce"),chkStr=postID+",",$(".wp-list-table input:checked").each(function(){$(this).val()!=postID&&(chkStr+=$(this).val()+",")}),$.ajax({url:wcp_settings.ajax_url,data:"post_ids="+chkStr+"&type="+wcp_settings.post_type+"&action=wcp_change_multiple_post_folder&folder_id="+folderID+"&nonce="+c+"&status="+wcp_settings.taxonomy_status+"&taxonomy="+l,method:"post",success:function(a){N(),aa(),K()}})):a.draggable.hasClass("attachment")&&(chkStr=a.draggable[0].attributes["data-id"].nodeValue,c=L(folderID,"nonce"),$(".attachments-browser li.attachment.selected").length>1&&(chkStr="",$(".attachments-browser li.attachment.selected").each(function(){chkStr+=$(this).data("id")+","})),$.ajax({url:wcp_settings.ajax_url,data:"post_ids="+chkStr+"&type="+wcp_settings.post_type+"&action=wcp_change_multiple_post_folder&folder_id="+folderID+"&nonce="+c+"&status="+wcp_settings.taxonomy_status+"&taxonomy="+l,method:"post",success:function(a){N(),aa(),K()}}))}}),$(".sticky-folders > ul > li > a:not(.ui-droppable)").droppable({accept:".wcp-move-file, .wcp-move-multiple, .attachments-browser li.attachment",hoverClass:"wcp-drop-hover",classes:{"ui-droppable-active":"ui-state-highlight"},drop:function(b,a){folderID=$(this).closest("li").data("folder-id"),a.draggable.hasClass("wcp-move-multiple")?$(".wp-list-table input:checked").length&&(chkStr="",$(".wp-list-table input:checked").each(function(){chkStr+=$(this).val()+","}),c=L(folderID,"nonce"),$.ajax({url:wcp_settings.ajax_url,data:"post_ids="+chkStr+"&type="+wcp_settings.post_type+"&action=wcp_change_multiple_post_folder&folder_id="+folderID+"&nonce="+c+"&status="+wcp_settings.taxonomy_status+"&taxonomy="+l,method:"post",success:function(a){"1"==(a=$.parseJSON(a)).status?(N(),aa(),K()):($(".folder-popup-form").hide(),$(".folder-popup-form").removeClass("disabled"),$("#error-folder-popup-message").html(a.message),$("#error-folder-popup").show())}})):a.draggable.hasClass("wcp-move-file")?(postID=a.draggable[0].attributes["data-id"].nodeValue,c=L(folderID,"nonce"),chkStr=postID+",",$(".wp-list-table input:checked").each(function(){$(this).val()!=postID&&(chkStr+=$(this).val()+",")}),$.ajax({url:wcp_settings.ajax_url,data:"post_ids="+chkStr+"&type="+wcp_settings.post_type+"&action=wcp_change_multiple_post_folder&folder_id="+folderID+"&nonce="+c+"&status="+wcp_settings.taxonomy_status+"&taxonomy="+l,method:"post",success:function(a){"1"==(a=$.parseJSON(a)).status?(N(),aa(),K()):($(".folder-popup-form").hide(),$(".folder-popup-form").removeClass("disabled"),$("#error-folder-popup-message").html(a.message),$("#error-folder-popup").show())}})):a.draggable.hasClass("attachment")&&(chkStr=a.draggable[0].attributes["data-id"].nodeValue,c=L(folderID,"nonce"),$(".attachments-browser li.attachment.selected").length>1&&(chkStr="",$(".attachments-browser li.attachment.selected").each(function(){chkStr+=$(this).data("id")+","})),s=chkStr,$.ajax({url:wcp_settings.ajax_url,data:"post_ids="+chkStr+"&type="+wcp_settings.post_type+"&action=wcp_change_multiple_post_folder&folder_id="+folderID+"&nonce="+c+"&status="+wcp_settings.taxonomy_status+"&taxonomy="+l,method:"post",success:function(a){N(),aa(),K()}}))}}),ac()}function K(){"yes"==wcp_settings.useFolderUndo&&($("#do-undo").addClass("active"),$(".undo-folder-action").removeClass("disabled"),setTimeout(function(){$("#do-undo").removeClass("active"),$(".undo-folder-action").addClass("disabled")},parseInt(wcp_settings.defaultTimeout)))}function L(a,b){if(t.length>0){for(i=0;i<t.length;i++)if(parseInt(t[i].folder_id)==parseInt(a))return t[i][b]}return""}function M(a){if(t.length>0){for(i=0;i<t.length;i++)if(parseInt(t[i].folder_id)==parseInt(a))return i}return null}function N(){if($(".media-toolbar").hasClass("media-toolbar-mode-select")&&$("ul.attachments li.selected").length&&($("ul.attachments li.selected").trigger("click"),$(".select-mode-toggle-button").trigger("click")),""!=s&&($("#js-tree-menu a.jstree-clicked").length>0||"-1"==l)){if($("#media-attachment-taxonomy-filter").length){s=s.split(",");for(var a=0;a<s.length;a++)""!=s[a]&&$(".attachments-browser li[data-id='"+s[a]+"']").remove()}s=""}$("#media-attachment-taxonomy-filter").length?aj(0):($.ajax({url:wcp_settings.ajax_url,data:"type="+wcp_settings.post_type+"&action=get_folders_default_list",method:"post",success:function(a){a=$.parseJSON(a),$(".header-posts .total-count").text(a.total_items),$(".un-categorised-items .total-count").text(a.empty_items),v=a.taxonomies,ac()}}),$(".folder-loader-ajax").addClass("active"),$("#folder-posts-filter").length?$("#folder-posts-filter").load(u+"&paged="+B+" #posts-filter",function(){var a={Title:"",Url:u+"&paged="+B};history.pushState(a,a.Title,a.Url),"show"!=wcp_settings.show_in_page||$(".tree-structure").length||$(".wp-header-end").before('<div class="tree-structure-content"><div class="tree-structure"><ul></ul><div class="clear clearfix"></div></div></div>'),Q(),O(),_()}):$("#wpbody").load(u+"&paged="+B+" #wpbody-content",!1,function(b){var a={Title:"",Url:u+"&paged="+B};history.pushState(a,a.Title,a.Url),"show"!=wcp_settings.show_in_page||$(".tree-structure").length||$(".wp-header-end").before('<div class="tree-structure-content"><div class="tree-structure"><ul></ul><div class="clear clearfix"></div></div></div>'),Q(),_()})),ah()}function O(){$(".form-loader-count").css("width","0"),"object"==typeof inlineEditPost&&(inlineEditPost.init(),$("#the-list").on("click",".editinline",function(){$(this).attr("aria-expanded","true"),inlineEditPost.edit(this)}),$(document).on("click",".inline-edit-save .save",function(){var a=$(this).closest("tr").attr("id");a=(a=a.replace("edit-","")).replace("post-",""),inlineEditPost.save(a)}),$(document).on("click",".inline-edit-save .cancel",function(){var a=$(this).closest("tr").attr("id");a=(a=a.replace("edit-","")).replace("post-",""),inlineEditPost.revert(a)})),"attachment"!=wcp_settings.post_type||($(".move-to-folder-top").length||$("#bulk-action-selector-top").append("<option class='move-to-folder-top' value='move_to_folder'>Move to Folder</option>"),$(".move-to-folder-bottom").length||$("#bulk-action-selector-bottom").append("<option class='move-to-folder-bottom' value='move_to_folder'>Move to Folder</option>")),Q()}function P(){if(t.length){var a=0;$("#js-tree-menu li.jstree-node").each(function(){null!=(folderPostId=M($(this).attr("id")))&&(1==t[folderPostId].is_high?$(this).addClass("is-high"):$(this).removeClass("is-high"),1==t[folderPostId].is_locked?($(this).addClass("is-locked"),a++):$(this).removeClass("is-locked"),1==t[folderPostId].is_sticky?$(this).addClass("is-sticky"):$(this).removeClass("is-sticky"),t[folderPostId].slug==wcp_settings.default_folder?$(this).addClass("is-current"):$(this).removeClass("is-current"))}),a>0&&a==$("#js-tree-menu li.jstree-node").length?$(".lock-unlock-all-folders").addClass("all-folder-locked").removeClass("open-folders").attr("data-folder-tooltip","Unlock all folders"):$(".lock-unlock-all-folders").addClass("open-folders").removeClass("all-folder-locked").attr("data-folder-tooltip","Lock all folders")}ab()}function Q(){if(P(),folderId=0,$(".tree-structure ul").html(""),folderStatus=!0,$(".jstree-clicked").length&&(folderID=$(".jstree-clicked").closest(".jstree-node").attr("id"),$(".jstree-node[id='"+folderID+"'] > ul.jstree-children > li.jstree-node").length?(folderStatus=!1,$(".jstree-node[id='"+folderID+"'] > ul.jstree-children > li.jstree-node").each(function(){fID=$(this).attr("id"),fName=$.trim($("#js-tree-menu").jstree(!0).get_node(fID).text),liHtml=y.replace(/__folder_id__/g,fID),liHtml=liHtml.replace(/__folder_name__/g,fName),selectedClass=$(this).hasClass("is-high")?"is-high":"",$(this).hasClass("is-locked")&&(selectedClass+=" is-locked"),liHtml=liHtml.replace(/__append_class__/g,selectedClass),$(".tree-structure ul").append(liHtml)})):$(".jstree-node[id='"+folderID+"']").closest("ul").hasClass("jstree-container-ul")||(folderStatus=!1)),folderStatus&&$("#js-tree-menu > ul > li.jstree-node").each(function(){fID=$(this).attr("id"),fName=$.trim($("#js-tree-menu").jstree(!0).get_node(fID).text),liHtml=y.replace(/__folder_id__/g,fID),liHtml=liHtml.replace(/__folder_name__/g,fName),selectedClass=$(this).hasClass("is-high")?"is-high":"",$(this).hasClass("is-locked")&&(selectedClass+=" is-locked"),liHtml=liHtml.replace(/__append_class__/g,selectedClass),$(".tree-structure ul").append(liHtml)}),_(),"attachment"!=wcp_settings.post_type||($(".move-to-folder-top").length||$("#bulk-action-selector-top").append("<option class='move-to-folder-top' value='move_to_folder'>Move to Folder</option>"),$(".move-to-folder-bottom").length||$("#bulk-action-selector-bottom").append("<option class='move-to-folder-bottom' value='move_to_folder'>Move to Folder</option>")),$(".sticky-folders .active-item").removeClass("active-item"),$("#js-tree-menu li.jstree-node.active-item").length){var a=$("#js-tree-menu li.jstree-node.active-item").data("folder-id");$(".sticky-folders .sticky-folder-"+a+" a").addClass("active-item")}J(),ah()}function R(){contentHeight=$(window).height()-$("#wpadminbar").height()-$(".sticky-wcp-custom-form").height()-30;var b=0;if($("#custom-scroll-menu").hasClass("mCustomScrollbar")){var a=$("#custom-scroll-menu"),c=a.find(".mCSB_dragger"),d=a.find(".mCSB_container").height();b=c.position().top/(a.height()-c.height())*(d-a.height()),$("#custom-scroll-menu").mCustomScrollbar("destroy")}$("#custom-scroll-menu").mCustomScrollbar({axis:"y",scrollButtons:{enable:!1},setHeight:contentHeight,theme:"3d",scrollbarPosition:"inside",scrollInertia:500,mouseWheelPixels:60}),0!=b&&$("#custom-scroll-menu").mCustomScrollbar("scrollTo",b+"px",{scrollInertia:0})}function S(){Q()}function T(){if(0==d&&e>=10)return $("#folder-limitation-message").html("You've reached the 10 folder limitation!"),$("#no-more-folder-credit").show(),!1;$("#save-folder-data").text("Submit"),$(".folder-form-errors").removeClass("active"),$("#add-update-folder-name").val(""),n&&(o=p,$("#add-update-folder-name").val($.trim($("#js-tree-menu").jstree(!0).get_node(p).text)+" #2"),p=$("#"+p+"_anchor").closest(".jstree-node").parent().parent().hasClass("jstree-node")?$("#"+p+"_anchor").closest(".jstree-node").parent().parent().attr("id"):0),$("#add-update-folder").removeClass("disabled"),$("#add-update-folder").show(),$("#add-update-folder-name").focus(),$(".dynamic-menu").remove()}function U(){folderName=$.trim($("#js-tree-menu").jstree(!0).get_node(p).text),parentID=$("#wcp_folder_"+p).closest("li.jstree-node").data("folder-id"),parentID==b&&(parentID=0),$("#update-folder-data").text("Submit"),$(".folder-form-errors").removeClass("active"),$("#update-folder-item-name").val(folderName),$("#update-folder-item").removeClass("disabled"),$("#update-folder-item").show(),$("#update-folder-item-name").focus(),$(".dynamic-menu").remove()}$(document).ready(function(){if($(document).on("click",".folder-settings-btn > a",function(a){a.stopPropagation(),$(".folder-settings-btn").toggleClass("active")}),$(document).on("click","body,html",function(){$(".folder-settings-btn").removeClass("active")}),$(document).on("click",".folder-setting-menu",function(a){a.stopPropagation()}),$(document).on("click","#unlock-all-folder",function(){$("#unlock-all-folder-popup").show()}),$(document).on("click","#lock-all-folder",function(){$("#lock-all-folder-popup").show()}),$(document).on("click",".lock-unlock-all-folders",function(){$(this).hasClass("open-folders")?$("#lock-all-folder-popup").show():$("#unlock-all-folder-popup").show()}),$(document).on("click",".lock-all-folder, .unlock-all-folder",function(b){var a=0;$(this).hasClass("lock-all-folder")&&(a=1),$(".folder-settings-btn").removeClass("active"),$(".form-loader-count").css("width","100%"),b.preventDefault(),$("#unlock-all-folder-popup, #lock-all-folder-popup").hide(),$.ajax({url:wcp_settings.ajax_url,data:{post_type:wcp_settings.post_type,nonce:wcp_settings.nonce,action:"premio_lock_unlock_all_folders",lock_folders:a},method:"post",success:function(a){if(a=$.parseJSON(a),$(".form-loader-count").css("width","0"),aa(),1==a.status&&t.length>0)for(var b=0;b<t.length;b++)t[b].is_locked=a.data.is_locked;P()}})}),$(document).on("change","#upload_media_folder",function(){var a=new FormData;if($("#upload_media_folder")[0].files.length){for(var b=0;b<$("#upload_media_folder")[0].files.length;b++)a.append("media_files_"+b,$("#upload_media_folder")[0].files[b]),a.append("media_file_name["+b+"]",$("#upload_media_folder")[0].files[b].webkitRelativePath);a.append("post_type",wcp_settings.post_type),a.append("nonce",wcp_settings.nonce),a.append("action","upload_premio_folder"),$(".form-loader-count").css("width","100%"),$.ajax({url:wcp_settings.ajax_url,type:"post",data:a,contentType:!1,processData:!1,success:function(a){if(1==(a=$.parseJSON(a)).status){var c=0;if(a.data.length>0)for(var b=0;b<a.data.length;b++){var e={folder_id:a.data[b].term_id,folder_count:0,is_sticky:a.data[b].is_sticky,is_high:a.data[b].is_high,is_locked:a.data[b].is_locked,nonce:a.data[b].nonce,slug:a.data[b].slug,is_deleted:0};0==c&&(c=a.data[b].term_id),t.push(e);var d=a.data[b].title;d=d.replace(/\\/g,""),$("#js-tree-menu").jstree().create_node(a.data[b].parent_id,{id:a.data[b].term_id,text:" "+d},"last",function(){$(".jstree-node[id='"+a.data[b].term_id+"']").attr("data-nonce",a.data[b].nonce),$(".jstree-node[id='"+a.data[b].term_id+"']").attr("data-slug",a.data[b].slug)})}0!=c&&(I=c),$(".form-loader-count").css("width","0px"),aa(),$("#media-attachment-taxonomy-filter").length&&aj(0),$("#media-attachment-taxonomy-filter").length&&(wp.media.frame.setState("insert"),null!==wp.media.frame.content.get()&& void 0!==wp.media.frame.content.get().collection?(wp.media.frame.content.get().collection.props.set({ignore:+new Date}),wp.media.frame.content.get().options.selection.reset()):wp.media.frame.library.props.set({ignore:+new Date})),$("#upload_media_folder").val(""),$(".folders-undo-notification").removeClass("active"),$("#folder-upload-message").addClass("active"),setTimeout(function(){$("#folder-upload-message").removeClass("active")},5e3)}}})}}),$("body").hasClass("jetpack-connected")&&!$("body").hasClass("mobile")&& !$("body").hasClass("folded")&&$("#adminmenuwrap").length){var a=parseInt($("#adminmenuwrap").width());"rtl"==$("html").prop("dir")?$(".wcp-content").css("right",a):$(".wcp-content").css("left",a)}$(document).on("click","#collapse-button",function(){setTimeout(function(){if($("body").hasClass("jetpack-connected")&&!$("body").hasClass("mobile")&& !$("body").hasClass("folded")&&$("#adminmenuwrap").length){var a=parseInt($("#adminmenuwrap").width());"rtl"==$("html").prop("dir")?$(".wcp-content").css("right",a):$(".wcp-content").css("left",a)}},50)}),v=wcp_settings.taxonomies,d=parseInt(wcp_settings.is_key_active),e=parseInt(wcp_settings.folders),l=parseInt(wcp_settings.selected_taxonomy),f=parseInt(wcp_settings.hasStars),g=parseInt(wcp_settings.hasChildren),B=parseInt(wcp_settings.currentPage),w=parseInt(wcp_settings.hasValidLicense),t=wcp_settings.folder_settings,W(),R(),$(document).ajaxComplete(function(c,d,b){var a=b.data;void 0!==a&&a.length&& -1!=a.indexOf("action=inline-save")&&N()});var k="1"==wcp_settings.isRTL||1==wcp_settings.isRTL?"w":"e";$(".wcp-content").resizable({resizeHeight:!1,handles:k,minWidth:100,maxWidth:500,resize:function(c,b){var a=b.size.width;for(a<=275?$(".plugin-button").addClass("d-block"):$(".plugin-button").removeClass("d-block"),a<=245&&(a=245),"1"==wcp_settings.isRTL?($("#wpcontent").css("padding-right",a+20+"px"),$("#wpcontent").css("padding-left","0px")):$("#wpcontent").css("padding-left",a+20+"px"),$("body.wp-admin #e-admin-top-bar-root.e-admin-top-bar--active").css("width","calc(100% - 160px - "+a+"px)"),newWidth=a-40,cssString="",classString="",i=0;i<=15;i++)classString+=" .space > .jstree-node >",cssString+="#js-tree-menu > "+classString+" .title { width: "+(currentWidth=newWidth-(13+20*i))+"px !important; } ",cssString+="#js-tree-menu > "+classString+" .dynamic-menu { left: "+(currentWidth-190)+"px !important; } ",am();$("#wcp-custom-style").html("<style>"+cssString+"</style>"),b.size.width<=185?(folderStatus="hide",$(".wcp-hide-show-buttons .toggle-buttons.show-folders").addClass("active"),$(".wcp-hide-show-buttons .toggle-buttons.hide-folders").removeClass("active"),$("#wcp-content").addClass("hide-folders-area"),"1"==wcp_settings.isRTL?($("#wpcontent").css("padding-right","20px"),$("#wpcontent").css("padding-left","0px")):$("#wpcontent").css("padding-left","20px"),$("body.wp-admin #e-admin-top-bar-root.e-admin-top-bar--active").css("width","calc(100% - 160px)")):$("#wcp-content").hasClass("hide-folders-area")&&(folderStatus="show",$(".wcp-hide-show-buttons .toggle-buttons.show-folders").removeClass("active"),$(".wcp-hide-show-buttons .toggle-buttons.hide-folders").addClass("active"),$("#wcp-content").addClass("no-transition"),$("#wcp-content").removeClass("hide-folders-area"),"1"==wcp_settings.isRTL?($("#wpcontent").css("padding-right",parseInt(wcp_settings.folder_width)+20+"px"),$("#wpcontent").css("padding-left","0px")):$("#wpcontent").css("padding-left",parseInt(wcp_settings.folder_width)+20+"px"),$("body.wp-admin #e-admin-top-bar-root.e-admin-top-bar--active").css("width","calc(100% - 160px - "+a+"px)"),setTimeout(function(){$("#wcp-content").removeClass("no-transition")},250))},stop:function(d,a){var b=a.size.width;a.size.width<=275?$(".plugin-button").addClass("d-block"):$(".plugin-button").removeClass("d-block"),b<=245&&(b=245),a.size.width<=185?(folderStatus="hide",$(".wcp-hide-show-buttons .toggle-buttons.show-folders").addClass("active"),$(".wcp-hide-show-buttons .toggle-buttons.hide-folders").removeClass("active"),$("#wcp-content").addClass("hide-folders-area"),"1"==wcp_settings.isRTL?($("#wpcontent").css("padding-right","20px"),$("#wpcontent").css("padding-left","0px")):$("#wpcontent").css("padding-left","20px"),$("body.wp-admin #e-admin-top-bar-root.e-admin-top-bar--active").css("width","calc(100% - 160px)"),$.ajax({url:wcp_settings.ajax_url,data:"type="+wcp_settings.post_type+"&action=wcp_change_folder_display_status&status="+folderStatus+"&nonce="+c,method:"post",success:function(a){am()}})):$("#wcp-content").hasClass("hide-folders-area")&&(folderStatus="show",$(".wcp-hide-show-buttons .toggle-buttons.show-folders").removeClass("active"),$(".wcp-hide-show-buttons .toggle-buttons.hide-folders").addClass("active"),$("#wcp-content").addClass("no-transition"),$("#wcp-content").removeClass("hide-folders-area"),"1"==wcp_settings.isRTL?($("#wpcontent").css("padding-right",parseInt(wcp_settings.folder_width)+20+"px"),$("#wpcontent").css("padding-left","0px")):$("#wpcontent").css("padding-left",parseInt(wcp_settings.folder_width)+20+"px"),$("body.wp-admin #e-admin-top-bar-root.e-admin-top-bar--active").css("width","calc(100% - 160px - "+b+"px)"),setTimeout(function(){$("#wcp-content").removeClass("no-transition")},250)),c=wcp_settings.nonce,wcp_settings.folder_width=a.size.width,$.ajax({url:wcp_settings.ajax_url,data:"type="+wcp_settings.post_type+"&action=wcp_change_post_width&width="+b+"&nonce="+c,method:"post",success:function(a){am()}}),a.size.width<=245&&($(".wcp-content").width(245),wcp_settings.folder_width=245)}}),$(document).on("contextmenu","#js-tree-menu .jstree-anchor",function(a){return z=a.pageX,A=a.pageY,$(this).find("span.folder-inline-edit").trigger("click"),!1}),$(document).on("click","#js-tree-menu .folder-actions span.folder-inline-edit",function(a){var c;a.stopImmediatePropagation(),a.stopPropagation(),0!=wcp_settings.can_manage_folder&&(isHigh=$(this).closest("li.jstree-node").hasClass("is-high"),isLocked=$(this).closest("li.jstree-node").hasClass("is-locked"),isSticky=$(this).closest("li.jstree-node").hasClass("is-sticky"),isDefault=$(this).closest("li.jstree-node").hasClass("is-current"),isStickyClass=!!isSticky,$(".dynamic-menu").remove(),$(".active-menu").removeClass("active-menu"),menuHtml="<div class='dynamic-menu "+(isLocked?"is-locked":"")+" "+(w?"":"no-key")+"' data-id='"+$(this).closest("li").prop("id")+"'><ul>",w||g?menuHtml+="<li class='new-folder'><a href='javascript:;'><span class=''><i class='pfolder-add-folder'></i></span>New Sub-folder</a></li>":menuHtml+="<li class='new-folder-pro'><a href='javascript:;'><span class=''><i class='pfolder-add-folder'></i></span>New Sub-folder (Activate)</a></li>",menuHtml+="<li class='rename-folder'><a href='javascript:;'><span class=''><i class='pfolder-edit'></i></span>Rename</a></li>",w?menuHtml+="<li class='sticky-folder'><a href='javascript:;'><span class='sticky-pin'><i class='pfolder-pin'></i></span>"+(isStickyClass?"Remove Sticky Folder":"Sticky Folder")+"</a></li>":menuHtml+="<li class='sticky-folder-pro'><a target='_blank' href='"+wcp_settings.register_url+"'><span class='sticky-pin'><i class='pfolder-pin'></i></span>Sticky Folder (Activate)</a></li>",w||f?menuHtml+="<li class='mark-folder'><a href='javascript:;'><span class=''><i class='pfolder-star'></i></span>"+(isHigh?"Remove Star":"Add a Star")+"</a></li>":menuHtml+="<li class='mark-folder-pro'><a target='_blank' href='"+wcp_settings.register_url+"'><span class=''><i class='pfolder-star'></i></span>"+(isHigh?"Remove Star (Activate)":"Add a Star (Activate)")+"</a></li>",w?(menuHtml+="<li class='lock-folder'><a href='javascript:;'><span class='dashicons dashicons-"+(isLocked?"unlock":"lock")+"'></span>"+(isLocked?"Unlock Folder":"Lock Folder")+"</a></li>",menuHtml+="<li class='duplicate-folder'><a href='javascript:;'><span class=''><i class='pfolder-clone'></i></span>Duplicate folder</a></li>"):(menuHtml+="<li class='lock-folder-pro'><a target='_blank' href='"+wcp_settings.register_url+"'><span class='dashicons dashicons-lock'></span>Lock Folder (Activate)</a></li>",menuHtml+="<li class='duplicate-folder-pro'><a target='_blank' href='"+wcp_settings.register_url+"'><span class=''><i class='pfolder-clone'></i></span>Duplicate folder (Activate)</a></li>"),hasPosts=parseInt($(this).closest("a.jstree-anchor").find(".premio-folder-count").text()),"attachment"==wcp_settings.post_type&&hasPosts&&(w?menuHtml+="<li class='download-folder'><a href='javascript:;'><span class=''><i class='pfolder-zip-file'></i></span>Download Zip</a></li>":menuHtml+="<li class='download-folder-pro'><a target='_blank' href='"+wcp_settings.register_url+"'><span class=''><i class='pfolder-zip-file'></i></span>Download Zip (Activate)</a></li>"),isDefault?menuHtml+="<li class='remove-default-folder'><a href='javascript:;'><span><i class='pfolder-active-icon'></i></span>Remove default folder</a></li>":menuHtml+="<li class='default-folders'><a href='javascript:;'><span><i class='pfolder-active-icon'></i></span>Open this folder by default</a></li>",menuHtml+="<li class='cut-folders'><a href='javascript:;'><span><i class='pfolder-cut'></i></span>Cut</a></li>",menuHtml+="<li class='copy-folders'><a href='javascript:;'><span><i class='pfolder-copy'></i></span>Copy</a></li>",C&&(menuHtml+="<li class='paste-folders'><a href='javascript:;'><span><i class='pfolder-paste'></i></span>Paste</a></li>"),menuHtml+="<li class='remove-folder'><a href='javascript:;'><span class=''><i class='pfolder-remove'></i></span>Delete</a></li></ul></div>",$("body").append(menuHtml),b!==a.pageX&&b!=a.pageY?($(".dynamic-menu").css("left",a.pageX),$(".dynamic-menu").css("top",a.pageY),c=a.pageY):b!==$(this).offset().top&&b!=$(this).offset().left?($(".dynamic-menu").css("left",$(this).offset().left),$(".dynamic-menu").css("top",$(this).offset().top),c=$(this).offset().top):($(".dynamic-menu").css("left",z),$(".dynamic-menu").css("top",A-10),c=A),$(this).parents("li.jstree-node").addClass("active-menu"),c+$(".dynamic-menu").height()>$(window).height()&&$(".dynamic-menu").css("margin-top",$(window).height()-(c+$(".dynamic-menu").height())))}),$(document).on("click",".sticky-folders .sticky-fldr > a",function(b){b.stopPropagation();var a=$(this).closest("li").data("folder-id");$(".jstree-node[id='"+a+"']").length&&($(".jstree-clicked").removeClass("jstree-clicked"),$(".active-item").removeClass("active-item"),$("#js-tree-menu").jstree("select_node",l),$(".jstree-node[id='"+a+"'] > a.jstree-anchor").trigger("click"),$(".jstree-node[id='"+a+"'] > a.jstree-anchor").addClass("jstree-clicked"),$(".sticky-folders .sticky-folder-"+a+" a").addClass("active-item"))}),$(document).on("click",".tree-structure a",function(b){b.stopPropagation();var a=$(this).data("id");$(".jstree-node[id='"+a+"']").length&&($(".jstree-clicked").removeClass("jstree-clicked"),$(".active-item").removeClass("active-item"),$("#js-tree-menu").jstree("select_node",l),$(".jstree-node[id='"+a+"'] > a.jstree-anchor").trigger("click"),$(".jstree-node[id='"+a+"'] > a.jstree-anchor").addClass("jstree-clicked"),$(".sticky-folders .sticky-folder-"+a+" a").addClass("active-item"))}),$(document).on("contextmenu",".sticky-fldr >  a",function(a){return a.stopPropagation(),z=a.pageX,A=a.pageY,$(this).find("span.update-inline-record").trigger("click"),!1}),$(document).on("click",".update-inline-record",function(a){var c;a.stopImmediatePropagation(),a.stopPropagation(),0!=wcp_settings.can_manage_folder&&(isHigh=$(this).closest("li.sticky-fldr").hasClass("is-high"),isLocked=$(this).closest("li.sticky-fldr").hasClass("is-locked"),isSticky=$(this).closest("li.sticky-fldr").hasClass("is-sticky"),isStickyClass=!!isSticky,$(".dynamic-menu").remove(),$(".active-menu").removeClass("active-menu"),menuHtml="<div class='dynamic-menu "+(isLocked?"is-locked":"")+" "+(w?"no-key":"")+" ' data-id='"+$(this).closest("li").data("folder-id")+"'><ul>",w||g?menuHtml+="<li class='new-folder'><a href='javascript:;'><span class=''><i class='pfolder-add-folder'></i></span>New Sub-folder</a></li>":menuHtml+="<li class='new-folder-pro'><a target='_blank' href='javascript:;'><span class=''><i class='pfolder-add-folder'></i></span>New Sub-folder (Activate)</a></li>",menuHtml+="<li class='rename-folder'><a href='javascript:;'><span class=''><i class='pfolder-edit'></i></span>Rename</a></li>",w?menuHtml+="<li class='sticky-folder'><a href='javascript:;'><span class='sticky-pin'><i class='pfolder-pin'></i></span>"+(isStickyClass?"Remove Sticky Folder":"Sticky Folder")+"</a></li>":menuHtml+="<li class='sticky-folder-pro'><a target='_blank' href='"+wcp_settings.register_url+"'><span class='sticky-pin'><i class='pfolder-pin'></i></span>Sticky Folder (Activate)</a></li>",w||f?menuHtml+="<li class='mark-folder'><a href='javascript:;'><span class=''><i class='pfolder-star'></i></span>"+(isHigh?"Remove Star":"Add a Star")+"</a></li>":menuHtml+="<li class='mark-folder-pro'><a target='_blank' href='"+wcp_settings.register_url+"'><span class=''><i class='pfolder-star'></i></span>"+(isHigh?"Remove Star (Activate)":"Add a Star (Activate)")+"</a></li>",w?(menuHtml+="<li class='lock-folder'><a href='javascript:;'><span class='dashicons dashicons-"+(isLocked?"unlock":"lock")+"'></span>"+(isLocked?"Unlock Folder":"Lock Folder")+"</a></li>",menuHtml+="<li class='duplicate-folder'><a href='javascript:;'><span class=''><i class='pfolder-clone'></i></span>Duplicate folder</a></li>"):(menuHtml+="<li class='lock-folder-pro'><a target='_blank' href='"+wcp_settings.register_url+"'><span class='dashicons dashicons-lock'></span>Lock Folder (Activate)</a></li>",menuHtml+="<li class='duplicate-folder-pro'><a target='_blank' href='"+wcp_settings.register_url+"'><span class=''><i class='pfolder-clone'></i></span>Duplicate folder (Activate)</a></li>"),hasPosts=parseInt($(this).closest("a.jstree-anchor").find(".premio-folder-count").text()),"attachment"==wcp_settings.post_type&&hasPosts&&(w?menuHtml+="<li target='_blank' class='download-folder'><a href='javascript:;'><span class=''><i class='pfolder-zip-file'></i></span>Download Zip</a></li>":menuHtml+="<li target='_blank' class='download-folder-pro'><a target='_blank' href='"+wcp_settings.register_url+"'><span class=''><i class='pfolder-zip-file'></i></span>Download Zip (Activate)</a></li>"),menuHtml+="<li class='remove-folder'><a href='javascript:;'><span class=''><i class='pfolder-remove'></i></span>Delete</a></li></ul></div>",$("body").append(menuHtml),b!==a.pageX&&b!=a.pageY?($(".dynamic-menu").css("left",a.pageX),$(".dynamic-menu").css("top",a.pageY),c=a.pageY):b!==$(this).offset().top&&b!=$(this).offset().left?($(".dynamic-menu").css("left",$(this).offset().left),$(".dynamic-menu").css("top",$(this).offset().top),c=$(this).offset().top):($(".dynamic-menu").css("left",z),$(".dynamic-menu").css("top",A-10),c=A),c+$(".dynamic-menu").height()>$(window).height()&&$(".dynamic-menu").css("margin-top",$(window).height()-(c+$(".dynamic-menu").height())))}),$(document).on("click",".dynamic-menu",function(a){a.stopImmediatePropagation(),a.stopPropagation()}),$(document).on("click",".new-folder-pro",function(a){a.preventDefault(),$(".dynamic-menu").remove(),$("#sub-folder-popup").show()}),$(document).on("click",".close-popup-button a",function(){$(".folder-popup-form").hide(),$(".jstree-node[id='"+p+"']").length&&$(".jstree-node[id='"+p+"'] > a.jstree-anchor").trigger("focus")}),$(document).on("click","body, html",function(){$(".dynamic-menu").remove()}),$(".wcp-hide-show-buttons .toggle-buttons").click(function(){var a="show";$(this).hasClass("hide-folders")&&(a="hide"),$(".wcp-hide-show-buttons .toggle-buttons").toggleClass("active"),c=wcp_settings.nonce,"show"==a?($("#wcp-content").addClass("no-transition"),$("#wcp-content").removeClass("hide-folders-area"),"1"==wcp_settings.isRTL?($("#wpcontent").css("padding-right",parseInt(wcp_settings.folder_width)+20+"px"),$("#wpcontent").css("padding-left","0px")):$("#wpcontent").css("padding-left",parseInt(wcp_settings.folder_width)+20+"px"),$("body.wp-admin #e-admin-top-bar-root.e-admin-top-bar--active").css("width","calc(100% - 160px - "+parseInt(wcp_settings.folder_width)+"px)"),setTimeout(function(){$("#wcp-content").removeClass("no-transition")},250)):($("#wcp-content").addClass("hide-folders-area"),"1"==wcp_settings.isRTL?($("#wpcontent").css("padding-right","20px"),$("#wpcontent").css("padding-left","0px")):$("#wpcontent").css("padding-left","20px"),$("body.wp-admin #e-admin-top-bar-root.e-admin-top-bar--active").css("width","calc(100% - 160px)")),$.ajax({url:wcp_settings.ajax_url,data:"type="+wcp_settings.post_type+"&action=wcp_change_folder_display_status&status="+a+"&nonce="+c,method:"post",success:function(a){am()}})}),J(),$(document).ajaxComplete(function(c,d,a){b!=a.data&&""!=a.data&&"string"==$.type(a.data)&& -1!=a.data.indexOf("action=query-attachments")&&J()}),$(document).on("click",".undo-button, .undo-folder-action:not(.disabled)",function(){$(".folders-undo-notification").removeClass("active"),$(this).hasClass("copy-paste-action")?0!=j&&(0!=G||0!=j?(0==F&&(F=""),$("#js-tree-menu").jstree("move_node","#"+j,"#"+h,i),H=0,F=0,j=0,i=0):0!=G&&(c=L(p=G,"nonce"),$.ajax({url:wcp_settings.ajax_url,data:"type="+wcp_settings.post_type+"&action=wcp_remove_folder&term_id="+p+"&nonce="+c,method:"post",success:function(c){if("1"==(c=$.parseJSON(c)).status){if($("#js-tree-menu").jstree().delete_node(p),d=parseInt(c.is_key_active),e=parseInt(c.folders),$("#current-folder").text(e),$("#ttl-fldr").text(10),$(".sticky-folders .sticky-folder-"+p).remove(),$("#media-attachment-taxonomy-filter").length){var a=parent.wp;b!=a.media&&(a.media.frame.setState("insert"),null!==a.media.frame.content.get()&& void 0!==a.media.frame.content.get().collection?(a.media.frame.content.get().collection.props.set({ignore:+new Date}),a.media.frame.content.get().options.selection.reset()):a.media.frame.library.props.set({ignore:+new Date}))}S(),aa(),$(".folder-popup-form").hide(),$(".folder-popup-form").removeClass("disabled"),N(),ab(),l==p&&$(".header-posts").trigger("click")}else $(".folder-popup-form").hide(),$(".folder-popup-form").removeClass("disabled"),$("#error-folder-popup-message").html(c.message),$("#error-folder-popup").show()}}))):"yes"==wcp_settings.useFolderUndo&&$.ajax({url:wcp_settings.ajax_url,type:"post",data:{post_type:wcp_settings.post_type,nonce:wcp_settings.nonce,action:"wcp_undo_folder_changes"},success:function(c){if($("#undo-done").addClass("active"),$(".undo-folder-action").addClass("disabled"),setTimeout(function(){$("#undo-done").removeClass("active")},2500),N(),$("#media-attachment-taxonomy-filter").length){var a=parent.wp;b!=a.media&&(a.media.frame.setState("insert"),null!==a.media.frame.content.get()&& void 0!==a.media.frame.content.get().collection?(a.media.frame.content.get().collection.props.set({ignore:+new Date}),a.media.frame.content.get().options.selection.reset()):a.media.frame.library.props.set({ignore:+new Date}))}}})}),$(document).on("click",".close-undo-box",function(a){a.preventDefault(),$("#do-undo").removeClass("active")})});function V(c){var a="Are you sure you want to delete the selected folder?",b="Items in the folder will not be deleted.";if(r=!1,1==c&&$("#menu-checkbox").is(":checked")){var d=0;if($("#js-tree-menu input.checkbox:checked").each(function(){!$(this).closest("li.jstree-node").hasClass("is-locked")&&d++}),0==d)return;if(r=!0,0==$("#js-tree-menu input.checkbox:checked").length){$(".folder-popup-form").hide(),$(".folder-popup-form").removeClass("disabled"),$("#error-folder-popup-message").html("Please select at least one folder to delete"),$("#error-folder-popup").show();return}$("#js-tree-menu input.checkbox:checked").length>1&&(a="Are you sure you want to delete the selected folders?",b="Items in the selected folders will not be deleted.")}$(".folder-popup-form").hide(),$(".folder-popup-form").removeClass("disabled"),$("#remove-folder-item").text("Yes, Delete it!"),$("#remove-folder-message").text(a),$("#remove-folder-notice").text(b),$("#confirm-remove-folder").show(),$("#remove-folder-item").focus()}function W(){$("#js-tree-menu").jstree({core:{cache:!1,animation:0,max_depth:g?"-1":1,check_callback:function(b,c,d,e,a){if($("*").removeClass("drag-bot").removeClass("drag-in").removeClass("drag-up"),("move_node"===b||"copy_node"===b)&&a&&a.dnd)switch(a.pos){case"a":a.origin.get_node(a.ref,!0).addClass("drag-bot"),nodeId=$(".drag-bot").attr("id"),$("#jstree-dnd").text("Below "+$.trim($("#js-tree-menu").jstree(!0).get_node(nodeId).text));break;case"i":if(!g)return!1;a.origin.get_node(a.ref,!0).addClass("drag-in"),nodeId=$(".drag-in").attr("id"),$("#jstree-dnd").text("Inside "+$.trim($("#js-tree-menu").jstree(!0).get_node(nodeId).text));break;case"b":a.origin.get_node(a.ref,!0).addClass("drag-up"),nodeId=$(".drag-up").attr("id"),$("#jstree-dnd").text("Above "+$.trim($("#js-tree-menu").jstree(!0).get_node(nodeId).text));break;default:$("#jstree-dnd").text($("#jstree-dnd").data("txt"))}return!0}},dnd:{is_draggable:function(a){return!($(".jstree-node[id='"+(folderMoveId=a[0].id)+"']").length&&$(".jstree-node[id='"+folderMoveId+"']").hasClass("is-locked"))}},data:{cache:!1},select_node:!1,search:{show_only_matches:!0,case_sensitive:!1,fuzzy:!1},plugins:["dnd","search","contextmenu"],contextmenu:{select_node:0,show_at_node:0,items:function(){return{}}}}).bind("ready.jstree",function(){$("#js-tree-menu .jstree-node").each(function(){var a=parseInt($(this).data("count"));$(".jstree-node[id='"+$(this).attr("id")+"'] > a span.premio-folder-count").text(a)}),$("span.premio-folder-count").each(function(){""==$(this).text()&&$(this).text(0)}),""!=l&&0!=l&&$(".jstree-node[id='"+l+"']").length&&($("#js-tree-menu").jstree("select_node",l),$(".sticky-folders .sticky-folder-"+l+" a").length&&$(".sticky-folders .sticky-folder-"+l+" a").addClass("active-item")),$(".ajax-preloader").hide(),$(".js-tree-data").show(),R(),ab(),$(".sticky-folders ul > li").length>0&&$(".sticky-folders").addClass("active"),Q(),J(),ab(),ah()}).bind("after_open.jstree",function(){J()}).bind("open_all.jstree",function(){J()}).bind("create_node.jstree",function(){J()}).bind("delete_node.jstree",function(){J()}).bind("close_all.jstree",function(){J()}).bind("after_close.jstree",function(){J()}).bind("move_node.jstree",function(b,a){"#"!=a.node.parent&&$("#js-tree-menu").jstree("open_node",a.node.parent),folderMoveId=a.node.id,orderString="",$("#js-tree-menu .jstree-node[id='"+folderMoveId+"']").closest("ul").children().each(function(){"undefined"!=$(this).attr("id")&&(orderString+=$(this).attr("id")+",")}),parentID=$("#"+folderMoveId+"_anchor").closest(".jstree-node").parent().parent().hasClass("jstree-node")?$("#"+folderMoveId+"_anchor").closest(".jstree-node").parent().parent().attr("id"):0,""!=orderString&&(h=a.old_parent,i=a.old_position,j=folderMoveId,$(".form-loader-count").css("width","100%"),$.ajax({url:wcp_settings.ajax_url,data:{term_ids:orderString,action:"wcp_save_folder_order",type:wcp_settings.post_type,nonce:wcp_settings.nonce,term_id:folderMoveId,parent_id:parentID},method:"post",success:function(a){"1"==(a=$.parseJSON(a)).status?($("#wcp_folder_parent").html(a.options),$(".form-loader-count").css("width","0"),N(),ac(),J(),Q()):($(".folder-popup-form").hide(),$(".folder-popup-form").removeClass("disabled"),$("#error-folder-popup-message").html(a.message),$("#error-folder-popup").show())}}))})}function X(){var a=$.trim($("#folder-search").val());$("#js-tree-menu").jstree("search",a)}function Y(a){$.ajax({url:wcp_settings.ajax_url,type:"post",data:"action=save_folder_last_status&post_type="+wcp_settings.post_type+"&post_id="+a+"&nonce="+wcp_settings.nonce,cache:!1,async:!1,success:function(){}})}function Z(){setTimeout(function(){if(currentStatus=!0,$("#js-tree-menu .jstree-node.jstree-leaf").length==$("#js-tree-menu .jstree-node").length)$("#expand-collapse-list").removeClass("all-open"),$("#expand-collapse-list").attr("data-folder-tooltip","Expand"),$("#expand-collapse-list .text").text("Expand");else{var a=$("#js-tree-menu .jstree-node.jstree-closed").length+$("#js-tree-menu .jstree-node.jstree-open").length;$("#js-tree-menu .jstree-node.jstree-closed").length==a?($("#expand-collapse-list").removeClass("all-open"),$("#expand-collapse-list").attr("data-folder-tooltip","Expand"),$("#expand-collapse-list .text").text("Expand")):($("#expand-collapse-list").addClass("all-open"),$("#expand-collapse-list").attr("data-folder-tooltip","Collapse"),$("#expand-collapse-list .text").text("Collapse"))}},500),J()}function _(){0==$(".tree-structure-content .tree-structure li").length?$(".tree-structure-content").hide():($(".tree-structure-content").show(),oldHeight=$(".tree-structure-content .tree-structure").height(),$(".tree-structure-content .tree-structure").height("auto"),$(".tree-structure-content .tree-structure").height()>56?$(".folders-toggle-button").show():$(".folders-toggle-button").hide(),newHeight=$(".tree-structure-content .tree-structure").height(),$(".tree-structure-content .tree-structure").attr("data-height",newHeight),$(".tree-structure-content").hasClass("active")?($(".tree-structure-content .tree-structure").height(newHeight),$(".tree-structure-content .tree-structure").attr("data-height",newHeight)):$(".tree-structure-content .tree-structure").height(oldHeight))}function aa(){$(".form-loader-count").css("width","0px"),$(".folder-loader-ajax").addClass("active"),$(".folder-loader-ajax img").removeClass("active"),$(".folder-loader-ajax svg#successAnimation").addClass("active").addClass("animated"),setTimeout(function(){$(".folder-loader-ajax").removeClass("active"),$(".folder-loader-ajax img").addClass("active"),$(".folder-loader-ajax svg#successAnimation").removeClass("active").removeClass("animated")},2e3)}function ab(){$(".sticky-folders > ul").html("");var a="";if($("#js-tree-menu li.jstree-node.is-sticky").each(function(){var b=$(this).attr("id"),c=$.trim($("#js-tree-menu").jstree(!0).get_node(b).text),d=$("li.jstree-node[id='"+b+"'] > a span.premio-folder-count").text(),e=$("li.jstree-node[id='"+b+"']").hasClass("is-high")?" is-high ":"",f=$("li.jstree-node[id='"+b+"']").hasClass("is-locked")?" is-locked ":"";a+="<li data-folder-id='"+b+"' class='sticky-fldr "+e+" "+f+" sticky-folder-"+b+"'><a href='javascript:;'><span class='folder-title'>"+c+"</span><span class='folder-actions'><span class='update-inline-record'><i class='pfolder-edit-folder'></i></span><span class='star-icon'><i class='pfolder-star'></i></span><span class='dashicons dashicons-lock'></span><span class='premio-folder-count'>"+d+"</span></span></a></li>"}),$(".sticky-folders > ul").html(a),$(".jstree-anchor.jstree-clicked").length){var b=$(".jstree-anchor.jstree-clicked").closest("li.jstree-node").attr("id");$(".sticky-folders .sticky-folder-"+b+" a").addClass("active-item")}$(".sticky-folders > ul > li").length>0?$(".sticky-folders").addClass("active"):$(".sticky-folders").removeClass("active"),J()}function ac(){if($("#media-attachment-taxonomy-filter").length&&($("#media-attachment-taxonomy-filter").each(function(){folders_media_options.terms=v;var b=$(this);currentDDVal=$(this).val(),b.html("<option value='all'>All Folders</option><option value='unassigned'>(Unassigned)</option>"),lastFolderData=v;for(var a=0;a<v.length;a++)b.append("<option value='"+v[a].term_id+"'>"+v[a].name+" ("+v[a].trash_count+")</option>");0!=I?($(".jstree-clicked").removeClass("jstree-clicked"),$("#js-tree-menu").jstree("select_node",I),b.val(I).trigger("change")):b.val(currentDDVal).trigger("change")}),$("select.folder_for_media").length)){var b=$("select.folder_for_media").val();$("select.folder_for_media option:not(:first-child):not(:last-child)").remove();for(var a=0;a<v.length;a++)$("select.folder_for_media option:last-child").before("<option value='"+v[a].term_id+"'>"+v[a].name+"</option>");""!=b&&$(".folder_for_media").val(b)}for(a=0;a<v.length;a++)$(".jstree-node[id='"+v[a].term_id+"'] > a.jstree-anchor span.premio-folder-count").text(v[a].trash_count),$(".sticky-folder-"+v[a].term_id+" .premio-folder-count").text(v[a].trash_count);if($("span.premio-folder-count").each(function(){""==$(this).text()&&$(this).text(0)}),$(".media-select-folder").length){for($(".media-select-folder").html("<option value=''>Select Folder</option><option value='-1'>(Unassigned)</option>"),a=0;a<v.length;a++)$(".media-select-folder").append("<option value='"+v[a].term_id+"'>"+v[a].name+" ("+v[a].trash_count+")</option>");$(".media-select-folder").val("")}""!=l&&$("#wcp_folder_"+l).addClass("active-item"),m&&($("#title_"+p).trigger("click"),m=!1),I=0}function ad(){$("#bulk-action-selector-top, #bulk-action-selector-bottom").val("-1"),0==$(".wp-list-table tbody input[type='checkbox']:checked").length?alert("Please select items to move in folder"):($("#bulk-move-folder").show(),$("#bulk-select").html("<option value=''>Loading...</option>"),$(".move-to-folder").attr("disabled",!0),$("#move-to-folder").prop("disabled",!0),$.ajax({url:wcp_settings.ajax_url,data:"type="+wcp_settings.post_type+"&action=wcp_get_default_list&active_id="+l,method:"post",success:function(a){if(a=$.parseJSON(a),$("#bulk-select").html("<option value=''>Select Folder</option><option value='-1'>(Unassigned)</option>"),$(".move-to-folder").prop("disabled",!1),$("#move-to-folder").prop("disabled",!1),1==a.status){var b=a.taxonomies;for(i=0;i<b.length;i++)$("#bulk-select").append("<option value='"+b[i].term_id+"'>"+b[i].name+"</option>")}}}))}function ae(a){""==l||0==l?(c=wcp_settings.nonce,$.ajax({url:wcp_settings.ajax_url,data:"post_id="+a+"&type="+wcp_settings.post_type+"&action=wcp_remove_post_folder&folder_id=-1&nonce="+c+"&status="+wcp_settings.taxonomy_status+"&taxonomy="+l,method:"post",success:function(a){N(),K()}})):$.ajax({url:wcp_settings.ajax_url,data:{post_id:a,action:"premio_check_for_other_folders",active_folder:l,type:wcp_settings.post_type,folder_id:-1,nonce:wcp_settings.nonce,status:wcp_settings.taxonomy_status,taxonomy:l},method:"post",success:function(a){-1==(a=$.parseJSON(a)).status?($("#unassigned_folders").val(a.data.post_id),$("#confirm-your-change").show()):(N(),K())}})}function af(b,c){$(".form-loader-count").css("width","100%");var a=0;0==l&&(a=$("#js-tree-menu > ul > li").length),$.ajax({url:wcp_settings.ajax_url,data:{copy_from:b,copy_to:c,action:"copy_premio_folders",nonce:wcp_settings.nonce,post_type:wcp_settings.post_type,folder_order:a},method:"post",success:function(a){if(1==(a=$.parseJSON(a)).status&&(G=a.parent_id,a.data.length>0))for(var b=0;b<a.data.length;b++)ag(a.data[b]);aa()}})}function ag(a){var d={folder_id:a.term_id,folder_count:0,is_sticky:a.is_sticky,is_high:a.is_high,is_locked:a.is_locked,nonce:a.nonce,slug:a.slug,is_deleted:0};t.push(d);var b=a.title;if(b=b.replace(/\\/g,""),$("#js-tree-menu").jstree().create_node(a.parent_id,{id:a.term_id,text:" "+b},"last",function(){$(".jstree-node[id='"+a.term_id+"']").attr("data-nonce",a.nonce),$(".jstree-node[id='"+a.term_id+"']").attr("data-slug",a.slug)}),a.child.length>0)for(var c=0;c<a.child.length;c++)ag(a.child[c]);P(),ab(),N(),$(".folders-undo-notification").removeClass("active"),$("#paste-message").addClass("active"),setTimeout(function(){$("#paste-message").removeClass("active")},5e3)}function ah(){$(".cut-folder-action, .copy-folder-action, .paste-folder-action, .delete-folder-action").addClass("disabled"),$("#js-tree-menu .jstree-anchor.jstree-clicked").length&&($(".cut-folder-action, .copy-folder-action, .delete-folder-action").removeClass("disabled"),""!=C&&0!=C&&l!=C&&$(".paste-folder-action").removeClass("disabled")),$(".all-posts").hasClass("active-item")&&""!=C&&0!=C&&$(".paste-folder-action").removeClass("disabled"),($("#menu-checkbox").is(":checked")||$("#menu-checkbox").is(":checked"))&&$("#js-tree-menu input.checkbox:checked").length>0&&$(".delete-folder-action").removeClass("disabled")}if($(window).on("resize",function(){R(),am()}),$(window).scroll(function(){am()}),$(document).ready(function(){$(document).on("click",".download-folder",function(){dataNonce=L(folderID=$(this).closest(".dynamic-menu").data("id"),"nonce"),window.location=wcp_settings.admin_url+"?action=download-folders&folder_id="+folderID+"&nonce="+dataNonce})}),$(document).ready(function(){$(document).on("click","#add-new-folder",function(){p=$("#js-tree-menu a.jstree-clicked").length?$("#js-tree-menu a.jstree-clicked").closest("li.jstree-node").attr("id"):0,n=!1,$("#add-update-folder-title").text("Add a new folder"),m=!1,T()}),$(document).on("change","#media-attachment-taxonomy-filter",function(a){x||($("#js-tree-menu").hasClass("jstree-default")&&$("#js-tree-menu").jstree(!0).deselect_all(),$("#dynamic-folders").length&&$("#dynamic-folders").hasClass("jstree-default")&&$("#dynamic-folders").jstree(!0).deselect_all(),$(".active-item").removeClass("active-item"),"all"==$(this).val()?$(".all-posts").addClass("active-item"):"unassigned"==$(this).val()?$(".un-categorised-items").addClass("active-item"):($("#js-tree-menu").jstree("select_node",$(this).val()),$(".sticky-folder-"+$(this).val()+" a").addClass("active-item")))}),$(document).on("click",".new-folder",function(){p=$(this).closest(".dynamic-menu").data("id"),m=!1,n=!1,$("#add-update-folder-title").text("Add a new folder"),T()}),$(document).on("click",".duplicate-folder",function(a){a.stopPropagation(),p=$(this).closest(".dynamic-menu").data("id"),$(".dynamic-menu").remove(),m=!1,n=!0,$("#add-update-folder-title").text("Duplicating to a new folder"),T(),S()}),$(document).on("submit","#save-folder-form",function(b){if(b.stopPropagation(),b.preventDefault(),folderNameDynamic=$.trim($("#add-update-folder-name").val()),""==$.trim(folderNameDynamic))$(".folder-form-errors").addClass("active"),$("#add-update-folder-name").focus();else{$("#save-folder-data").html('<span class="dashicons dashicons-update"></span>'),$("#add-update-folder").addClass("disabled");var a=p;m&&(a=0),g||(a=0),q=0==a?$("#js-tree-menu > ul > li.jstree-node").length:$("#js-tree-menu > ul > li.jstree-node[id='"+a+"'] > ul.jstree-children > li").length+1,$.ajax({url:wcp_settings.ajax_url,data:{parent_id:a,type:wcp_settings.post_type,action:"wcp_add_new_folder",nonce:wcp_settings.nonce,term_id:a,order:q,name:folderNameDynamic,is_duplicate:n,duplicate_from:o},method:"post",success:function(c){if(result=$.parseJSON(c),$(".folder-popup-form").hide(),$(".folder-popup-form").removeClass("disabled"),-1==result.status)$("#no-more-folder-credit").show();else if("1"==result.status){if(d=parseInt(result.is_key_active),e=parseInt(result.folders),$("#current-folder").text(e),$("#ttl-fldr").text(10),Z(),S(),result.data.length)for(var a=0;a<result.data.length;a++){var f={folder_id:result.data[a].term_id,folder_count:result.data[a].folder_count,is_sticky:result.data[a].is_sticky,is_high:result.data[a].is_high,is_locked:result.data[a].is_locked,nonce:result.data[a].nonce,slug:result.data[a].slug,is_deleted:0};t.push(f);var b=result.data[a].title;b=b.replace(/\\/g,""),$("#js-tree-menu").jstree().create_node(result.parent_id,{id:result.data[a].term_id,text:" "+b},"last",function(){$(".jstree-node[id='"+result.data[a].term_id+"']").attr("data-nonce",result.data[a].nonce),$(".jstree-node[id='"+result.data[a].term_id+"']").attr("data-slug",result.data[a].slug),$(".jstree-node[id='"+result.data[a].term_id+"']").attr("data-parent",result.parent_id),$(".jstree-node[id='"+result.data[a].term_id+"'] > a.jstree-anchor .premio-folder-count").text(result.data[a].folder_count)}),$(".jstree-node[id='"+result.parent_id+"']").length&&$("#js-tree-menu").jstree("open_node",$("#"+result.parent_id)),$(".jstree-node[id='"+result.parent_id+"']").length?$(".jstree-node[id='"+result.parent_id+"'] > a.jstree-anchor").trigger("focus"):$(".jstree-node[id='"+result.data[a].term_id+"']").length&&$(".jstree-node[id='"+result.data[a].term_id+"'] > a.jstree-anchor").trigger("focus")}aa(),P(),$("#dynamic-folders .jstree-clicked").length&&$("#js-tree-menu .jstree-clicked").removeClass("jstree-clicked"),$("#media-attachment-taxonomy-filter").length&&(p=result.term_id,aj(0),resetSelectMediaDropDown()),n&&N(),n=!1,o=0}else $("#error-folder-popup-message").html(result.message),$("#error-folder-popup").show()}})}return!1})}),$(document).ready(function(){$("#inline-update").click(function(){$("#js-tree-menu a.jstree-clicked").length&&(p=$("#js-tree-menu a.jstree-clicked").closest("li.jstree-node").attr("id"),U())}),$(document).on("click",".rename-folder",function(a){a.stopPropagation(),p=$(this).closest(".dynamic-menu").data("id"),U(),$(".dynamic-menu").remove()}),$(document).on("click",".form-cancel-btn",function(){$(".folder-popup-form").hide(),$(".jstree-node[id='"+p+"']").length?$(".jstree-node[id='"+p+"'] > a.jstree-anchor").trigger("focus"):$("#js-tree-menu .jstree-anchor.jstree-clicked").length&&$("#js-tree-menu .jstree-anchor.jstree-clicked").trigger("focus")}),$(document).on("click",".folder-popup-form",function(a){$(".folder-popup-form").hide(),$(".jstree-node[id='"+p+"']").length?$(".jstree-node[id='"+p+"'] > a.jstree-anchor").trigger("focus"):$("#js-tree-menu .jstree-anchor.jstree-clicked").length&&$("#js-tree-menu .jstree-anchor.jstree-clicked").trigger("focus")}),$(document).on("click",".popup-form-content",function(a){a.stopPropagation()}),$(document).on("submit","#update-folder-form",function(a){return a.stopPropagation(),a.preventDefault(),folderNameDynamic=$("#update-folder-item-name").val(),""==$.trim(folderNameDynamic)?($(".folder-form-errors").addClass("active"),$("#update-folder-item-name").focus()):($("#update-folder-data").html('<span class="dashicons dashicons-update"></span>'),$("#update-folder-item").addClass("disabled"),c=L(p,"nonce"),b==(parentID=$(".jstree-node[id='"+p+"']").closest("li.jstree-node").attr("id"))&&(parentID=0),$.ajax({url:wcp_settings.ajax_url,data:{parent_id:parentID,type:wcp_settings.post_type,action:"wcp_update_folder",nonce:c,term_id:p,order:q,name:folderNameDynamic},method:"post",success:function(a){"1"==(result=$.parseJSON(a)).status?($("#js-tree-menu").jstree("rename_node",result.id," "+result.term_title),$(".sticky-folder-"+result.id+" .folder-title").html(result.term_title),null!=(folderPostId=M(result.id))&&(t[folderPostId].nonce=result.nonce,t[folderPostId].slug=result.slug),S(),$(".folder-popup-form").hide(),$(".folder-popup-form").removeClass("disabled"),aa(),$("#media-attachment-taxonomy-filter").length&&aj(0)):($(".folder-popup-form").hide(),$(".folder-popup-form").removeClass("disabled"),$("#error-folder-popup-message").html(result.message),$("#error-folder-popup").show()),$("#dynamic-folders .jstree-clicked").length&&$("#js-tree-menu .jstree-clicked").removeClass("jstree-clicked")}})),!1})}),$(document).ready(function(){$(document).on("click","#inline-remove, .delete-folder-action:not(.disabled)",function(){$("#menu-checkbox").is(":checked")?($(".dynamic-menu").remove(),V(1)):$("#js-tree-menu a.jstree-clicked").length&&($("#js-tree-menu a.jstree-clicked").closest(".jstree-node").hasClass("is-locked")||(p=$("#js-tree-menu a.jstree-clicked").closest("li.jstree-node").attr("id"),V(1),$(".dynamic-menu").remove(),$(".active-menu").removeClass("active-menu")))}),$(document).on("click","#js-tree-menu input.checkbox",function(){ah()}),$(document).on("click","#menu-checkbox",function(){$(this).is(":checked")?($(".js-tree-data").addClass("show-folder-checkbox"),$("#menu-checkbox").prop("checked",!0)):($(".js-tree-data input.checkbox").attr("checked",!1),$(".js-tree-data").removeClass("show-folder-checkbox"),$("#menu-checkbox").prop("checked",!1))}),$(document).on("click","#menu-checkbox",function(){$(this).is(":checked")?($("#menu-checkbox").prop("checked",!0),$(".js-tree-data").addClass("show-folder-checkbox")):($("#menu-checkbox").prop("checked",!1),$(".js-tree-data input.checkbox").attr("checked",!1),$(".js-tree-data").removeClass("show-folder-checkbox"))}),$(document).on("click",".folder-checkbox, .input-checkbox",function(a){a.stopImmediatePropagation(),a.stopPropagation()}),$(document).on("click",".remove-folder",function(){folderID=$(this).closest("li.jstree-node").data("id"),$(this).closest(".dynamic-menu").hasClass("is-locked")||(p=$(this).closest(".dynamic-menu").data("id"),V(0),$(".dynamic-menu").remove(),$(".active-menu").removeClass("active-menu"))}),$(document).on("click","#remove-folder-item",function(a){a.stopPropagation(),$(".folder-popup-form").addClass("disabled"),$("#remove-folder-item").html('<span class="dashicons dashicons-update"></span>'),c=L(p,"nonce"),r?function b(){if($("#menu-checkbox").is(":checked")&&$("#js-tree-menu input.checkbox:checked").length>0){var a="",c=!1;$("#js-tree-menu input.checkbox:checked").each(function(){!$(this).closest("li.jstree-node").hasClass("is-locked")&&(a+=$(this).closest("li.jstree-node").attr("id")+",",$(this).closest("li.jstree-node").hasClass("jstree-clicked")&&(c=!0))}),""!=a&&($(".form-loader-count").css("width","100%"),$.ajax({url:wcp_settings.ajax_url,data:"type="+wcp_settings.post_type+"&action=wcp_remove_muliple_folder&term_id="+a+"&nonce="+wcp_settings.nonce,method:"post",success:function(a){if(a=$.parseJSON(a),$(".form-loader-count").css("width","0px"),"1"==a.status){for(d=parseInt(a.is_key_active),e=parseInt(a.folders),$("#current-folder").text(e),i=0;i<a.term_ids.length;i++)$("#js-tree-menu").jstree().delete_node(a.term_ids[i]);$("#ttl-fldr").text(10),aa(),$(".folder-popup-form").hide(),$(".folder-popup-form").removeClass("disabled"),N(),ab(),aa(),$("#js-tree-menu li.jstree-node").removeClass("has-sub-tree"),$("#js-tree-menu li.jstree-node").each(function(){$(this).find("ul.ui-sortable li").length?$(this).addClass("has-sub-tree"):$(this).removeClass("active")}),$("#wcp_folder_"+l).length||($(".header-posts a").trigger("click"),l=0)}else window.location.reload();$("#menu-checkbox").attr("checked",!1),$("#js-tree-menu input.checkbox").attr("checked",!1),$("#js-tree-menu").removeClass("show-folder-checkbox")}}))}}():$.ajax({url:wcp_settings.ajax_url,data:"type="+wcp_settings.post_type+"&action=wcp_remove_folder&term_id="+p+"&nonce="+c,method:"post",success:function(b){if("1"==(b=$.parseJSON(b)).status){var a,c=$(".jstree-node[id='"+(a=p)+"']").next().length?$(".jstree-node[id='"+a+"']").next().attr("id"):$(".jstree-node[id='"+a+"']").prev().length?$(".jstree-node[id='"+a+"']").prev().attr("id"):$(".jstree-node[id='"+a+"']").parent().parent().hasClass("jstree-node")?$(".jstree-node[id='"+a+"']").parent().parent().attr("id"):0;$("#js-tree-menu").jstree().delete_node(p),d=parseInt(b.is_key_active),e=parseInt(b.folders),$("#current-folder").text(e),$("#ttl-fldr").text(10),$(".sticky-folders .sticky-folder-"+p).remove(),S(),aa(),$(".folder-popup-form").hide(),$(".folder-popup-form").removeClass("disabled"),N(),ab(),0!=c&&$("#"+c+"_anchor").length?$("#"+c+"_anchor").trigger("click"):$(".header-posts").trigger("click")}else $(".folder-popup-form").hide(),$(".folder-popup-form").removeClass("disabled"),$("#error-folder-popup-message").html(b.message),$("#error-folder-popup").show()}})})}),$(document).ready(function(){$(document).on("click",".mark-folder",function(a){a.stopPropagation(),c=L(folderID=$(this).closest(".dynamic-menu").data("id"),"nonce"),$(".form-loader-count").css("width","100%"),$(".dynamic-menu").remove(),$(".active-menu").removeClass("active-menu"),$.ajax({url:wcp_settings.ajax_url,data:"term_id="+folderID+"&type="+wcp_settings.post_type+"&action=wcp_mark_un_mark_folder&nonce="+c,method:"post",cache:!1,success:function(a){a=$.parseJSON(a),$(".form-loader-count").css("width","0%"),"1"==a.status?(folderPostId=M(a.id),"1"==a.marked?($("li.jstree-node[id='"+a.id+"']").addClass("is-high"),$(".sticky-folder-"+a.id).addClass("is-high"),null!=folderPostId&&(t[folderPostId].is_high=1)):($("li.jstree-node[id='"+a.id+"']").removeClass("is-high"),$(".sticky-folder-"+a.id).removeClass("is-high"),null!=folderPostId&&(t[folderPostId].is_high=0)),S(),aa(),$(".jstree-node[id='"+a.id+"']").length&&$(".jstree-node[id='"+a.id+"'] > a.jstree-anchor").trigger("focus")):($(".folder-popup-form").hide(),$(".folder-popup-form").removeClass("disabled"),$("#error-folder-popup-message").html(a.message),$("#error-folder-popup").show())}})}),$(document).on("click",".lock-folder",function(a){a.stopPropagation(),c=L(folderID=$(this).closest(".dynamic-menu").data("id"),"nonce"),$(".form-loader-count").css("width","100%"),$(".dynamic-menu").remove(),$(".active-menu").removeClass("active-menu"),$.ajax({url:wcp_settings.ajax_url,data:"term_id="+folderID+"&type="+wcp_settings.post_type+"&action=wcp_lock_unlock_folder&nonce="+c,method:"post",cache:!1,success:function(a){a=$.parseJSON(a),$(".form-loader-count").css("width","0%"),"1"==a.status?(folderPostId=M(a.id),"1"==a.marked?($("li.jstree-node[id='"+a.id+"']").addClass("is-locked"),$(".sticky-folder-"+a.id).addClass("is-locked"),null!=folderPostId&&(t[folderPostId].is_locked=1)):($("li.jstree-node[id='"+a.id+"']").removeClass("is-locked"),$(".sticky-folder-"+a.id).removeClass("is-locked"),null!=folderPostId&&(t[folderPostId].is_locked=0)),S(),aa(),$(".jstree-node[id='"+a.id+"']").length&&$(".jstree-node[id='"+a.id+"'] > a.jstree-anchor").trigger("focus")):($(".folder-popup-form").hide(),$(".folder-popup-form").removeClass("disabled"),$("#error-folder-popup-message").html(a.message),$("#error-folder-popup").show())}})}),$(document).on("click",".sticky-folder",function(b){b.stopPropagation(),folderID=$(this).closest(".dynamic-menu").data("id");var a=0;folderPostId=M(folderID),$("li.jstree-node[id='"+folderID+"']").hasClass("is-sticky")?($("li.jstree-node[id='"+folderID+"']").removeClass("is-sticky"),$(".sticky-folders .sticky-folder-"+p).remove(),null!=folderPostId&&(t[folderPostId].is_sticky=0)):(a=1,$("li.jstree-node[id='"+folderID+"']").addClass("is-sticky"),null!=folderPostId&&(t[folderPostId].is_sticky=1)),$(".dynamic-menu").hide(),c=L(folderID,"nonce"),ab(),$.ajax({url:wcp_settings.ajax_url,data:"term_id="+folderID+"&type="+wcp_settings.post_type+"&action=wcp_make_sticky_folder&nonce="+c+"&status="+a,method:"post",cache:!1,success:function(a){"1"==(a=$.parseJSON(a)).status&&$(".jstree-node[id='"+a.id+"']").length&&$(".jstree-node[id='"+a.id+"'] > a.jstree-anchor").trigger("focus")}})})}),$(document).ready(function(){$(document).on("click",".jstree-node .jstree-icon",function(){folderID=$(this).closest("li.jstree-node").attr("id"),folderStatus=$("li.jstree-node[id='"+folderID+"']").hasClass("jstree-open")?1:0,$(".form-loader-count").css("width","100%"),c=L(folderID,"nonce"),Z(),$.ajax({url:wcp_settings.ajax_url,data:"is_active="+folderStatus+"&action=save_wcp_folder_state&term_id="+folderID+"&nonce="+c,method:"post",success:function(a){$(".form-loader-count").css("width","0"),"0"==(a=$.parseJSON(a)).status||($("#wcp_folder_"+folderID).hasClass("active")?($("#wcp_folder_"+folderID).removeClass("active"),$("#wcp_folder_"+folderID).find("ul.ui-sortable:first-child > li").slideUp(),folderStatus=0):($("#wcp_folder_"+folderID).addClass("active"),$("#wcp_folder_"+folderID).find("ul.ui-sortable:first-child > li").slideDown(),folderStatus=1),aa())}}),P()})}),$(document).ready(function(){$(document).on("click","#js-tree-menu a.jstree-anchor",function(c){if(B=1,c.stopPropagation(),$(".un-categorised-items").removeClass("active-item"),$(".header-posts a").removeClass("active-item"),$("active-item").removeClass("active-item"),$("#dynamic-tree-folders .jstree-clicked").removeClass("jstree-clicked"),l=$(this).closest("li.jstree-node").attr("id"),p=$(this).closest("li.jstree-node").attr("id"),$(".sticky-folders .sticky-folder-"+l+" a").addClass("active-item"),$("#js-tree-menu .jstree-clicked").removeClass("jstree-clicked"),$(this).addClass("jstree-clicked"),$("#media-attachment-taxonomy-filter").length){x=0;var b=$(this).closest("li.jstree-node").attr("id");$("#media-attachment-taxonomy-filter").val(b),$("#media-attachment-taxonomy-filter").trigger("change"),thisSlug=L(b,"slug"),u=wcp_settings.page_url+thisSlug+"&paged="+B;var a={Title:thisSlug,Url:u};history.pushState(a,a.Title,a.Url),Y(thisSlug),$(".custom-media-select").removeClass("active")}else{var d=L(l,"slug");u=wcp_settings.page_url+d+"&paged="+B,$(".form-loader-count").css("width","100%"),$("#folder-posts-filter").length?$("#folder-posts-filter").load(u+" #posts-filter",function(){var a={Title:d,Url:u};history.pushState(a,a.Title,a.Url),Y(d),"show"!=wcp_settings.show_in_page||$(".tree-structure").length||$(".wp-header-end").before('<div class="tree-structure-content"><div class="tree-structure"><ul></ul><div class="clear clearfix"></div></div></div>'),O()}):$("#wpbody").load(u+" #wpbody-content",function(){var a={Title:d,Url:u};history.pushState(a,a.Title,a.Url),Y(d),"show"!=wcp_settings.show_in_page||$(".tree-structure").length||$(".wp-header-end").before('<div class="tree-structure-content"><div class="tree-structure"><ul></ul><div class="clear clearfix"></div></div></div>'),O()})}Q(),$(".sticky-folders .sticky-folder-"+l+" a").addClass("active-item"),ah()}),$(document).on("click","#dynamic-tree-folders a.jstree-anchor",function(a){l="",a.stopPropagation(),$(".un-categorised-items").removeClass("active-item"),$(".header-posts a").removeClass("active-item"),$(".active-item").removeClass("active-item"),$("#js-tree-menu .jstree-clicked").removeClass("jstree-clicked"),B=1,$("#media-attachment-taxonomy-filter").length?(x=1,$("#media-attachment-dynamic-filter").val($(this).closest("li").prop("id")).trigger("change"),$("#media-attachment-taxonomy-filter").val("all")):($("#media-attachment-dynamic-filter").val("dynamic-folders"),folderSlug=$(this).text(),u=wcp_settings.page_url+"&paged="+B+"&ajax_action=premio_dynamic_folders&dynamic_folder="+$(this).attr("id"),$(".form-loader-count").css("width","100%"),$("#folder-posts-filter").length?$("#folder-posts-filter").load(u+" #posts-filter",function(){var a={Title:folderSlug,Url:u};history.pushState(a,a.Title,a.Url),"show"!=wcp_settings.show_in_page||$(".tree-structure").length||$(".wp-header-end").before('<div class="tree-structure-content"><div class="tree-structure"><ul></ul><div class="clear clearfix"></div></div></div>'),O()}):$("#wpbody").load(u+" #wpbody-content",function(){var a={Title:folderSlug,Url:u};history.pushState(a,a.Title,a.Url),"show"!=wcp_settings.show_in_page||$(".tree-structure").length||$(".wp-header-end").before('<div class="tree-structure-content"><div class="tree-structure"><ul></ul><div class="clear clearfix"></div></div></div>'),O()})),ah()}),$(".header-posts").click(function(){if(l="",x=0,$(".wcp-container .route").removeClass("active-item"),$(".un-categorised-items").removeClass("active-item"),$(".sticky-folders .active-item").removeClass("active-item"),$(".header-posts a").addClass("active-item"),$(".jstree-clicked").removeClass("jstree-clicked"),$("#media-attachment-taxonomy-filter").length){l="",$("#media-attachment-taxonomy-filter").val("all"),$("#media-attachment-taxonomy-filter").trigger("change");var a={Title:"",Url:wcp_settings.page_url};history.pushState(a,a.Title,a.Url),Y("all"),Q()}else B=1,u=wcp_settings.page_url+"&paged="+B,$(".form-loader-count").css("width","100%"),$("#folder-posts-filter").length?$("#folder-posts-filter").load(u+" #posts-filter",function(){var a={Title:"",Url:u};history.pushState(a,a.Title,a.Url),Y("all"),"show"!=wcp_settings.show_in_page||$(".tree-structure").length||$(".wp-header-end").before('<div class="tree-structure-content"><div class="tree-structure"><ul></ul><div class="clear clearfix"></div></div></div>'),Q(),O()}):$("#wpbody").load(u+" #wpbody-content",function(){var a={Title:"",Url:u};history.pushState(a,a.Title,a.Url),Y("all"),"show"!=wcp_settings.show_in_page||$(".tree-structure").length||$(".wp-header-end").before('<div class="tree-structure-content"><div class="tree-structure"><ul></ul><div class="clear clearfix"></div></div></div>'),Q(),O()});ah()}),$(".un-categorised-items").click(function(){if(l="-1",x=0,$(".wcp-container .route").removeClass("active-item"),$(".header-posts a").removeClass("active-item"),$(".un-categorised-items").addClass("active-item"),$(".sticky-folders .active-item").removeClass("active-item"),$(".jstree-clicked").removeClass("jstree-clicked"),$("#media-attachment-taxonomy-filter").length){$("#media-attachment-taxonomy-filter").val("unassigned"),$("#media-attachment-taxonomy-filter").trigger("change");var a={Title:"",Url:wcp_settings.page_url+"-1"};history.pushState(a,a.Title,a.Url),Y("-1"),Q()}else B=1,u=wcp_settings.page_url+"-1&paged="+B,$(".form-loader-count").css("width","100%"),$("#folder-posts-filter").length?$("#folder-posts-filter").load(u+" #posts-filter",function(){var a={Title:"",Url:u};history.pushState(a,a.Title,a.Url),Y("-1"),"show"!=wcp_settings.show_in_page||$(".tree-structure").length||$(".wp-header-end").before('<div class="tree-structure-content"><div class="tree-structure"><ul></ul><div class="clear clearfix"></div></div></div>'),Q(),O()}):$("#wpbody").load(u+" #wpbody-content",function(){var a={Title:"",Url:u};history.pushState(a,a.Title,a.Url),Y("-1"),"show"!=wcp_settings.show_in_page||$(".tree-structure").length||$(".wp-header-end").before('<div class="tree-structure-content"><div class="tree-structure"><ul></ul><div class="clear clearfix"></div></div></div>'),Q(),O()});ah()}),$("#expand-collapse-list").click(function(a){a.stopPropagation(),statusType=0,$(this).hasClass("all-open")?($(this).removeClass("all-open"),statusType=0,$(this).attr("data-folder-tooltip","Expand"),$("#expand-collapse-list .text").text("Expand"),$("#js-tree-menu").jstree("close_all")):($(this).addClass("all-open"),statusType=1,$(this).attr("data-folder-tooltip","Collapse"),$("#expand-collapse-list .text").text("Collapse"),$("#js-tree-menu").jstree("open_all")),s="",$("#js-tree-menu .jstree-node:not(.jstree-leaf)").each(function(){s+=$(this).attr("id")+","}),""!=s&&($(".form-loader-count").css("width","100%"),c=wcp_settings.nonce,$.ajax({url:wcp_settings.ajax_url,data:"type="+wcp_settings.post_type+"&action=wcp_change_all_status&status="+statusType+"&folders="+s+"&nonce="+c,method:"post",success:function(a){$(".form-loader-count").css("width","0"),"0"==(a=$.parseJSON(a)).status&&($(".folder-popup-form").hide(),$(".folder-popup-form").removeClass("disabled"),$("#error-folder-popup-message").html(a.message),$("#error-folder-popup").show(),window.location.reload(!0))}}))}),Z(),$("#dynamic-tree-folders").jstree({core:{cache:!1,animation:0,dnd:{is_draggable:function(a){return!1}}},data:{cache:!1},select_node:!1,search:{show_only_matches:!0,case_sensitive:!1,fuzzy:!1},plugins:["dnd","search"]}).bind("ready.jstree",function(){$(".dynamic-tree-data").show()})}),$(document).ready(function(){$(document).on("click","body, html",function(){$(".folder-order").removeClass("active")}),$(document).on("click","#sort-order-list",function(a){a.stopPropagation(),$(".folder-order").toggleClass("active")}),$(document).on("click",".folder-sort-menu a:not(.pro-feature)",function(a){a.stopPropagation(),a.preventDefault(),$(".form-loader-count").css("width","100%"),$(".folder-order").removeClass("active"),lastOrderStatus=$(this).attr("data-sort"),$.ajax({url:wcp_settings.ajax_url,data:"type="+wcp_settings.post_type+"&action=wcp_folders_by_order&nonce="+wcp_settings.nonce+"&order="+$(this).attr("data-sort"),method:"post",success:function(a){1==(a=$.parseJSON(a)).status&&($("#js-tree-menu").jstree().destroy(),$("#js-tree-menu").append("<ul></ul>"),$("#js-tree-menu ul").html(a.data),W(),v=a.terms,ac()),$(".form-loader-count").css("width","0"),Q()}})})}),$(document).ready(function(){$(document).on("keyup","#folder-search",function(){X()}),$(document).on("change","#folder-search",function(){X()}),$(document).on("blur","#folder-search",function(){X()})}),$(document).ready(function(){$(document).on("click",".folders-toggle-button",function(){dbStatus="show",$(".tree-structure-content").hasClass("active")?($(".tree-structure-content .tree-structure").animate({height:"40px"},100,function(){$(".tree-structure-content").removeClass("active")}),dbStatus="hide"):(newHeight=parseInt($(".tree-structure-content .tree-structure").attr("data-height")),$(".tree-structure-content .tree-structure").animate({height:newHeight},100,function(){$(".tree-structure-content").addClass("active")})),$.ajax({url:wcp_settings.ajax_url,data:"type="+wcp_settings.post_type+"&action=wcp_hide_folders&status="+dbStatus+"&nonce="+wcp_settings.nonce,method:"post",success:function(a){am()}})})}),$(document).ready(function(){$(document).on("click",".thumbnail-hover-box a",function(a){return a.stopPropagation(),a.stopImmediatePropagation(),a.preventDefault(),window.open($(this).prop("href"),"_blank"),wp.media.frame.close(),!1}),$(document).on("click","#doaction",function(a){return"move_to_folder"==$("#bulk-action-selector-top").val()?(ad(),!1):"edit"==$("#bulk-action-selector-top").val()&&"object"==typeof inlineEditPost?(inlineEditPost.setBulk(),!1):void 0}),$(document).on("click","#doaction2",function(a){return"move_to_folder"==$("#bulk-action-selector-bottom").val()?(ad(),!1):"edit"==$("#bulk-action-selector-bottom").val()&&"object"==typeof inlineEditPost?(inlineEditPost.setBulk(),!1):void 0}),$(document).on("submit","#bulk-folder-form",function(a){a.stopPropagation(),a.preventDefault(),""!=$("#bulk-select").val()&&(chkStr="",$(".wp-list-table input:checked").each(function(){chkStr+=$(this).val()+","}),""!=$("#bulk-select").val()&&("-1"==$("#bulk-select").val()?$.ajax({url:wcp_settings.ajax_url,data:"post_id="+chkStr+"&type="+wcp_settings.post_type+"&action=wcp_remove_post_folder&folder_id="+$(this).val()+"&nonce="+wcp_settings.nonce+"&status="+wcp_settings.taxonomy_status+"&taxonomy="+l,method:"post",success:function(a){$("#bulk-move-folder").hide(),N(),aa()}}):(c=L($("#bulk-select").val(),"nonce"),$.ajax({url:wcp_settings.ajax_url,data:"post_ids="+chkStr+"&type="+wcp_settings.post_type+"&action=wcp_change_multiple_post_folder&folder_id="+$("#bulk-select").val()+"&nonce="+c+"&status="+wcp_settings.taxonomy_status+"&taxonomy="+l,method:"post",success:function(a){a=$.parseJSON(a),$("#bulk-move-folder").hide(),"1"==a.status?(N(),aa()):($(".folder-popup-form").hide(),$(".folder-popup-form").removeClass("disabled"),$("#error-folder-popup-message").html(a.message),$("#error-folder-popup").show())}}))))})}),$(document).ready(function(){$(document).on("click","#remove-from-all-folders:not(.disabled), #remove-from-current-folder:not(.disabled)",function(){$("#remove-from-all-folders, #remove-from-current-folder").addClass("disabled");var a="all";$(this).hasClass("remove-from-current-folder")&&(a="current"),$("#confirm-your-change").hide(),$.ajax({url:wcp_settings.ajax_url,data:{post_id:$("#unassigned_folders").val(),action:"wcp_remove_post_folder",active_folder:l,type:wcp_settings.post_type,folder_id:-1,nonce:wcp_settings.nonce,status:wcp_settings.taxonomy_status,taxonomy:l,remove_from:a},method:"post",success:function(a){$("#remove-from-all-folders, #remove-from-current-folder").removeClass("disabled"),aa(),N(),K()}})}),$(document).on("click",".default-folders a",function(d){d.preventDefault();var a=$(this).closest(".dynamic-menu").data("id"),b=M(a);if($(".dynamic-menu").hide(),null!=b){var c=t[b].slug;wcp_settings.default_folder=c,$.ajax({url:wcp_settings.ajax_url,type:"post",data:"action=save_premio_default_folder&post_type="+wcp_settings.post_type+"&post_slug="+c+"&nonce="+wcp_settings.nonce+"&folder_id="+a,cache:!1,async:!1,success:function(a){P(),"1"==(a=$.parseJSON(a)).status&&$(".jstree-node[id='"+a.folder_id+"']").length&&$(".jstree-node[id='"+a.folder_id+"'] > a.jstree-anchor").trigger("focus")}})}}),$(document).on("click",".remove-default-folder a",function(a){a.preventDefault(),$(".dynamic-menu").hide();var b=$(this).closest(".dynamic-menu").data("id");wcp_settings.default_folder="",$.ajax({url:wcp_settings.ajax_url,type:"post",data:"action=remove_premio_default_folder&post_type="+wcp_settings.post_type+"&nonce="+wcp_settings.nonce+"&folder_id="+b,cache:!1,async:!1,success:function(a){P(),"1"==(a=$.parseJSON(a)).status&&$(".jstree-node[id='"+a.folder_id+"']").length&&$(".jstree-node[id='"+a.folder_id+"'] > a.jstree-anchor").trigger("focus")}})}),$(document).on("click",".dynamic-menu .copy-folders",function(a){a.stopPropagation(),C=$(this).closest(".dynamic-menu").data("id"),D="copy",$(".dynamic-menu").remove(),aa(),$(".folders-undo-notification").removeClass("active"),$("#copy-message").addClass("active"),setTimeout(function(){$("#copy-message").removeClass("active")},5e3),ah(),$(".jstree-node[id='"+C+"']").length&&$(".jstree-node[id='"+C+"'] > a.jstree-anchor").trigger("focus")}),$(document).on("click",".dynamic-menu .cut-folders",function(a){a.stopPropagation(),C=$(this).closest(".dynamic-menu").data("id"),D="cut",$(".dynamic-menu").remove(),aa(),$(".folders-undo-notification").removeClass("active"),$("#cut-message").addClass("active"),F=$("#"+C).data("parent"),setTimeout(function(){$("#cut-message").removeClass("active")},5e3),ah(),$(".jstree-node[id='"+C+"']").length&&$(".jstree-node[id='"+C+"'] > a.jstree-anchor").trigger("focus")}),$(document).on("click",".dynamic-menu .paste-folders",function(b){b.stopPropagation();var a=$(this).closest(".dynamic-menu").data("id");0!=C&&""!=C&&a!=C&&("cut"==D?(F=$("#"+C).data("parent"),G=C,H=$("#"+C).index(),$("#js-tree-menu").jstree("move_node","#"+C,"#"+a,0),E="cut",$(".folders-undo-notification").removeClass("active"),$("#paste-message").addClass("active"),setTimeout(function(){$("#paste-message").removeClass("active"),H=0,F=0},5e3),$(".jstree-node[id='"+a+"']").length&&$(".jstree-node[id='"+a+"'] > a.jstree-anchor").trigger("focus")):af(C,a),ah(),D="",C=0),$(".dynamic-menu").remove()}),$(document).on("click",".paste-folder-action",function(){(""==l||isNaN(l))&&(l=0),0!=C&&""!=C&&C!=l&&("cut"==D?(F=$("#"+C).data("parent"),G=C,H=$("#"+C).index()+1,""!=l&&0!=l?$("#js-tree-menu").jstree("move_node","#"+C,"#"+l,0):$("#js-tree-menu").jstree("move_node","#"+C,"#",$("#js-tree-menu > ul > li.jstree-node").length),$(".folders-undo-notification").removeClass("active"),$("#paste-message").addClass("active"),setTimeout(function(){$("#paste-message").removeClass("active")},5e3),$(".jstree-node[id='"+l+"']").length&&$(".jstree-node[id='"+l+"'] > a.jstree-anchor").trigger("focus")):((""==l||isNaN(l))&&(l=0),af(C,l)),ah(),D="",C=0)}),$(document).on("click",".cut-folder-action",function(a){a.stopPropagation(),""!=l&&0!=l&&(C=l,D="cut",$(".folders-undo-notification").removeClass("active"),$("#cut-message").addClass("active"),setTimeout(function(){$("#cut-message").removeClass("active")},5e3),ah(),$(".jstree-node[id='"+C+"']").length&&$(".jstree-node[id='"+C+"'] > a.jstree-anchor").trigger("focus"))}),$(document).on("click",".copy-folder-action",function(a){a.stopPropagation(),""!=l&&0!=l&&(C=l,D="copy",$(".folders-undo-notification").removeClass("active"),$("#copy-message").addClass("active"),setTimeout(function(){$("#copy-message").removeClass("active")},5e3),ah(),$(".jstree-node[id='"+C+"']").length&&$(".jstree-node[id='"+C+"'] > a.jstree-anchor").trigger("focus"))}),"attachment"==wcp_settings.post_type?($(".upload-media-action").removeClass("disabled"),$("#upload_media_folder").prop("disabled",!1)):$("#upload_media_folder").remove()}),"attachment"==wcp_settings.post_type){$(document).ready(function(){"show"==wcp_settings.show_in_page&&$(".wp-header-end").before('<div class="tree-structure-content"><div class="tree-structure"><ul></ul><div class="clear clearfix"></div></div><div class="folders-toggle-button"><span></span></div></div>'),S(),_()});var ai=null;function aj(a){ai=$.ajax({url:wcp_settings.ajax_url,data:"type="+wcp_settings.post_type+"&action=wcp_get_default_list&active_id="+l,method:"post",beforeSend:function(){null!=ai&&ai.abort()},success:function(d){if(d=$.parseJSON(d),$(".header-posts .total-count").text(d.total_items),$(".un-categorised-items .total-count").text(d.empty_items),selectedVal=$("#media-attachment-taxonomy-filter").val(),"all"!=selectedVal&&1==a){var c=parent.wp;b!=c.media&&(c.media.frame.setState("insert"),null!==c.media.frame.content.get()&& void 0!==c.media.frame.content.get().collection?(c.media.frame.content.get().collection.props.set({ignore:+new Date}),c.media.frame.content.get().options.selection.reset()):c.media.frame.library.props.set({ignore:+new Date}))}v=d.taxonomies,ac(),""!=l&&$("#wcp_folder_"+l).addClass("active-item"),m&&($("#title_"+p).trigger("click"),m=!1)}})}function a(){$(".media-frame-content .media-toolbar").width($(".media-frame-content").width()-20)}function ak(d,e,b){var c="";if(b){var a=new Date;a.setTime(a.getTime()+864e5*b),c="; expires="+a.toUTCString()}document.cookie=d+"="+(e||"")+c+"; path=/"}function al(a){document.cookie=a+"=; Max-Age=-99999999;"}function am(){$(".media-position").length||$(".media-frame-content .media-toolbar").before("<div class='media-position'></div>"),$(".media-position").length&&(a(),(thisPosition=$(".media-position").offset().top-$(window).scrollTop())<=32?($(".media-frame-content .media-toolbar").addClass("sticky-media"),$(".media-position").height($(".media-frame-content .media-toolbar").outerHeight())):($(".media-frame-content .media-toolbar").removeClass("sticky-media"),$(".media-position").height(1)))}a(),$(window).resize(function(){a()}),$(document).on("click",".button.organize-button",function(){$(".media-frame").hasClass("mode-select")?al("media-select-mode"):ak("media-select-mode","on",7),$("button.button.media-button.select-mode-toggle-button").trigger("click"),$(".media-frame").hasClass("mode-select")?($(".media-info-message").addClass("active"),$(".select-all-item-btn").addClass("active")):($(".media-info-message, .custom-media-select").removeClass("active"),$(".select-all-item-btn").removeClass("active"))}),$(document).on("click",".select-mode-toggle-button",function(){setTimeout(function(){$(".media-frame").hasClass("mode-select")||ak("media-select-mode","off",-1),$(".media-frame").hasClass("mode-select")?($(".media-info-message").addClass("active"),$(".select-all-item-btn").addClass("active")):($(".media-info-message, .custom-media-select").removeClass("active"),$(".select-all-item-btn").removeClass("active"))},10)}),$(document).on("click",".select-all-item-btn",function(){$("ul.attachments li:not(.selected)").trigger("click")}),$(document).on("change",".folder_for_media",function(){"add-folder"==$(this).val()&&(p=0,m=!0,T())}),$(window).scroll(function(){am()})}$(document).ready(function(){"attachment"==wcp_settings.post_type&&$("#tmpl-media-frame").length&&(k=setInterval(function(){$("button.button.media-button.select-mode-toggle-button").length&&(clearInterval(k),$("button.button.media-button.select-mode-toggle-button").after("<button class='button organize-button'>Bulk Organize</button>"),$(".media-toolbar-secondary").append("<span class='media-info-message'>Drag and drop your media files to the relevant folders</span>"),$(".delete-selected-button").before("<button type='button' class='button button-primary select-all-item-btn'>Select All</button>"),$(".media-toolbar-secondary").after("<div class='custom-media-select'>Move Selected files to: <select class='media-select-folder'></select></div>"),$(".media-toolbar").append("<div style='clear:both;'></div><div class='media-folder-loader'><span>Uploading files</span> <span id='current_upload_files'></span>/<span id='total_upload_files'></span><div class='folder-progress'><div class='folder-meter orange-bg'><span></span></div></div></div>"),$(".wcp-custom-form").length&&(b!==wp.Uploader&&wp.Uploader.queue.on("reset",function(){aj(1)}),$(document).ajaxComplete(function(b,c,a){void 0!==(actionName=a.data)&&actionName.length&&0==actionName.indexOf("action=delete-post&id=")&&aj(0)})),setTimeout(function(){-1!=(docReferrar=document.referrer).indexOf("wp-admin/upload.php")?"on"==(mediaMode=function(e){for(var c=e+"=",d=document.cookie.split(";"),b=0;b<d.length;b++){for(var a=d[b];" "==a.charAt(0);)a=a.substring(1,a.length);if(0==a.indexOf(c))return a.substring(c.length,a.length)}return null}("media-select-mode"))&&($("button.button.media-button.select-mode-toggle-button").trigger("click"),$(".media-frame").hasClass("mode-select")?$(".media-info-message").addClass("active"):$(".media-info-message, .custom-media-select").removeClass("active")):al("media-select-mode"),aj(1)},1e3))},1e3)),$(document).on("click",".attachments-browser ul.attachments .thumbnail",function(){"attachment"==wcp_settings.post_type&&$(".media-toolbar").hasClass("media-toolbar-mode-select")&&(0==$("ul.attachments li.selected").length?$(".custom-media-select").removeClass("active"):$(".custom-media-select").addClass("active"))}),$(document).on("change",".media-select-folder",function(){if("attachment"==wcp_settings.post_type&&""!=$(this).val()){var a="";$(".attachments-browser li.attachment.selected").each(function(){a+=$(this).attr("data-id")+","}),""!=a&&("-1"==$(this).val()?$.ajax({url:wcp_settings.ajax_url,data:"post_id="+a+"&type="+wcp_settings.post_type+"&action=wcp_remove_post_folder&folder_id="+$(this).val()+"&nonce="+wcp_settings.nonce+"&status="+wcp_settings.taxonomy_status+"&taxonomy="+l,method:"post",success:function(a){0!=p&&p!=$(".media-select-folder").val()&&$("ul.attachments li.selected").remove(),N(),aa()}}):(c=L($(this).val(),"nonce"),$.ajax({url:wcp_settings.ajax_url,data:"post_ids="+a+"&type="+wcp_settings.post_type+"&action=wcp_change_multiple_post_folder&folder_id="+$(this).val()+"&nonce="+c+"&status="+wcp_settings.taxonomy_status+"&taxonomy="+l,method:"post",success:function(a){a=$.parseJSON(a),$("#bulk-move-folder").hide(),"1"==a.status?(0!=p&&p!=$(".media-select-folder").val()&&$("ul.attachments li.selected").remove(),N(),aa()):($(".folder-popup-form").hide(),$(".folder-popup-form").removeClass("disabled"),$("#error-folder-popup-message").html(a.message),$("#error-folder-popup").show())}})))}})}),$(document).ready(function(){"yes"==wcp_settings.use_shortcuts&&($(document).on("click",".view-shortcodes",function(a){a.preventDefault(),$("#keyboard-shortcut").show()}),$(document).on("keydown",function(a){var c=!!a.ctrlKey||!!a.metaKey;if(!($("input").is(":focus")||$("textarea").is(":focus"))&&a.shiftKey&&(78==a.keyCode||78==a.which)&&(a.preventDefault(),$("#add-new-folder").trigger("click")),(113==a.keyCode||113==a.which)&&$("#js-tree-menu .jstree-anchor").is(":focus")&&(p=$("#js-tree-menu .jstree-anchor:focus").closest("li.jstree-node").attr("id"),U(),$(".dynamic-menu").remove()),c&&(67==a.keyCode||67==a.which)&&$("#js-tree-menu .jstree-anchor").is(":focus")&&(C=$("#js-tree-menu .jstree-anchor:focus").closest("li.jstree-node").attr("id"),D="copy",$(".folders-undo-notification").removeClass("active"),$("#copy-message").addClass("active"),setTimeout(function(){$("#copy-message").removeClass("active")},5e3),ah()),c&&(88==a.keyCode||88==a.which)&&$("#js-tree-menu .jstree-anchor").is(":focus")&&(a.preventDefault(),C=$("#js-tree-menu .jstree-anchor:focus").closest("li.jstree-node").attr("id"),D="cut",$(".folders-undo-notification").removeClass("active"),$("#cut-message").addClass("active"),setTimeout(function(){$("#cut-message").removeClass("active")},5e3),ah()),c&&(86==a.keyCode||86==a.which)&&$("#js-tree-menu .jstree-anchor").is(":focus")&&(a.preventDefault(),(""==(l=$("#js-tree-menu .jstree-anchor:focus").closest("li.jstree-node").attr("id"))||isNaN(l))&&(l=0),0!=C&&""!=C&&C!=l&&("cut"==D?(F=$("#"+C).data("parent"),G=C,H=$("#"+C).index()+1,""!=l&&0!=l?$("#js-tree-menu").jstree("move_node","#"+C,"#"+l,0):$("#js-tree-menu").jstree("move_node","#"+C,"#",$("#js-tree-menu > ul > li.jstree-node").length),$(".folders-undo-notification").removeClass("active"),$("#paste-message").addClass("active"),setTimeout(function(){$("#paste-message").removeClass("active")},5e3)):((""==l||isNaN(l))&&(l=0),af(C,l)),ah(),D="",C=0)),c&&(68==a.keyCode||68==a.which)&&$("#js-tree-menu .jstree-anchor").is(":focus")&&(a.preventDefault(),p=$("#js-tree-menu .jstree-anchor:focus").closest("li.jstree-node").attr("id"),$(".dynamic-menu").remove(),m=!1,n=!0,$("#add-update-folder-title").text("Duplicating to a new folder"),T()),c&&(75==a.keyCode||75==a.which)&&$("#keyboard-shortcut").show(),(46==a.keyCode||46==a.which||8==a.keyCode||8==a.which)&&$("#js-tree-menu .jstree-anchor").is(":focus")&&($("#js-tree-menu .jstree-anchor:focus").closest("li.jstree-node").hasClass("is-locked")||(p=$("#js-tree-menu .jstree-anchor:focus").closest("li.jstree-node").attr("id"),V(0),$(".dynamic-menu").remove(),$(".active-menu").removeClass("active-menu"))),c&&(40==a.keyCode||40==a.which)&&$("#js-tree-menu .jstree-anchor").is(":focus")){p=$("#js-tree-menu .jstree-anchor:focus").closest("li.jstree-node").attr("id");var b=parseInt($("#"+p).data("parent")),d=parseInt($("#"+p).index())+1,e=parseInt($("#"+p).data("child"));isNaN(b)&&(b=$("li#"+p).parents("li.jstree-node").length?$("li#"+p).parents("li.jstree-node").data("folder"):0,e=$("li#"+p).parents("li.jstree-node").length?$("li#"+p).parents("li.jstree-node").children():$("#js-tree-menu > ul > li").length),0==b&&(b=""),e==d?$("#js-tree-menu").jstree("move_node","#"+p,"#"+b,0):$("#js-tree-menu").jstree("move_node","#"+p,"#"+b,d+1)}if(c&&(38==a.keyCode||38==a.which)&&$("#js-tree-menu .jstree-anchor").is(":focus")){p=$("#js-tree-menu .jstree-anchor:focus").closest("li.jstree-node").attr("id");var b=parseInt($("#"+p).data("parent")),d=parseInt($("#"+p).index())-1,e=parseInt($("#"+p).data("child"));isNaN(b)&&(d=parseInt($("#"+p).index())-1,b=$("li#"+p).parents("li.jstree-node").length?$("li#"+p).parents("li.jstree-node").data("folder"):0,e=$("li#"+p).parents("li.jstree-node").length?$("li#"+p).parents("li.jstree-node").children():$("#js-tree-menu > ul > li").length),0==b&&(b=""),-1==d?$("#js-tree-menu").jstree("move_node","#"+p,"#"+b,e):$("#js-tree-menu").jstree("move_node","#"+p,"#"+b,d)}(27==a.keyCode||27==a.which)&&$(".folder-popup-form").hide()}))})})